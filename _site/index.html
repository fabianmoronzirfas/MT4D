<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Mehr Zeit für Gestaltung</title>
   <meta name="author" content="fabiantheblind" />

   <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />


</head>
<body>



<div class="site">
   <div id="printfriendly">
<script src="http://cdn.printfriendly.com/printfriendly.js" type="text/javascript"></script><a href="http://www.printfriendly.com" style=" color:#6D9F00; text-decoration:none;" class="printfriendly" onclick="window.print(); return false;" title="Printer Friendly and PDF"><img style="border:none;" src="http://cdn.printfriendly.com/button-print-gry20.png" alt="Print Friendly and PDF"/></a>
  </div> 
  <div class="title">
    <a href="/">Home</a>
    <!-- <a class="extra" href="/">home</a> -->
  </div>

  <h1>BA von Fabian Morón Zirfas</h1>

<h2>Mehr Zeit für Gestaltung</h2>

<h2>Einleitung</h2>

<p>Diese Arbeit setzt sich mit der Automation von Design-Prozessen auseinander. Sie ist keine komplette Anleitung zum Erlernen von Programmier Grundkenntnissen, diese können für viele verschieden Sprachen im "World Wide Web" gefunden werden, sondern eine Auseinandersetzung was Automation durch Programmierung für Designer leisten kann und welche Bereiche sie nicht abdeckt. Dies wird durch einige kurze Beispiele illustriert.
Sie, die Arbeit, ist der versuch die Mystik und nebulösen Vorstellungen die sich um Computerprogramme ranken zu brechen und die Schnittstellen die aktuelle Grafikprogramme bieten auf zu zeigen.</p>

<p>Abschliessend soll im Fazit der Erkenntniszuwachs aus all dem zusammengefasst werden.</p>

<h1>Bevor sie Einsteigen</h1>

<p>Bevor sie weiterlesen einige Hinweise. Wenn sie noch keine Erfahrungen mit Programmierung gemacht haben lassen sie sich nicht abschrecken. Es werden einige für den Laien unverständliche Zeilen vorkommen und einige die sich aus dem Kontext oder den Namen der Funktionen erschliessen lassen. Falls sie die Beispiele in Abschnitt Eins und Zwei ausprobieren möchten lesen sie den Abschnitt Terminologie [NUMMER] "Hello World" zuerst. Dort wird erklärt wie und wo sie Skripte schreiben und ausführen können. Es werden Fachausdrücke vorkommen die ebenfalls im Abschnitt Terminologie [NUMMER] erklärt werden. Ab dem Abschnitt [NUMMER] Das Szenario steigen wir dann voll in das lesen und wenn sie möchten schreiben von Skripten ein. Dafür sollte zumindest der eben genannte Abschnitt einmal nachvollzogen worden sein. Wenn die dort dargestellten Zusammenhänge und Konstrukte zu komplex sind verschaffen sie sich etwas Übung. Es existiert eine schöne Webseite genannt <a href="http://www.codecademy.com/#!/exercises/0">codecademy.com</a> auf der sie in einigen lustigen Aufgaben durch die Grundlagen von JavaScript geführt werden. Wenn mal etwas nicht funktioniert - verzweifeln sie nicht. Kontrollieren sie ihre Schreibweise und suchen sie sich weiterführende Informationen im Netz. Die einfachste Möglichkeit ist den gewünschten Befehl samt JavaScript (z.B. "alert() JavaScript") in einer Suchmaschine einzugeben. Da das Netz voll von JavaScript ist spuckt es in 99% der Fälle auch die richtige Dokumentation aus. Werfen sie ebenfalls einen Blick in die Referenz-Liste. Dort finden sie viele Ressourcen für "Scripting" die ihnen den Einstig erleichtern werden.</p>

<blockquote><p>Scripting languages assume that there already exists a collection of useful components written in other languages. Scripting languages aren't intended for writing applications from scratch; they are intended primarily for plugging together components<br/>
Scripting: Higher Level Programming
for the 21st Century by John K. Ousterhout (<a href="http://www.tcl.tk/doc/scripting.html">online</a>)</p></blockquote>

<h2>Teil 1 Wann soll ich Skripten?</h2>

<p>Auch wenn Aufgaben auf unterschiedliche Weise mit verschiedenen Programmiersprachen gelöst werden können haben sich spezielle Anwendungsgebiete für die einzelnen Sprachen ergeben. Ganz unabhängig davon, dass sich in unserem Fall Adobe Anwendungen mit JavaScript ansprechen lassen macht es Sinn eine Skriptsprache zu verwenden um die bereits in höheren Sprachen implementierten Funktionen zu verbinden.</p>

<p>JavaScript ist unser Kleber. Wir müssen das Rad nicht neu erfinden. Wir können jedoch unseren Arbeitsablauf durch gezielte Befehlsketten von repetitive Aufgaben befreien. Ich bin mir sicher dass ein Grossteil aller Gestalter die vorgefertigte Software für ihre Arbeit verwenden schon einmal an den Punkt kamen wo sie sich dachten: "Warum kann mein Programm DAS nicht," ([MARGINALSPALTE]DAS steht hier für eine gewünschte Funktionsweise) "es ist doch alles da. Der Knopf und danach diesen Knopf!". Scripting erlaubt es uns diese beiden Knöpfe mit einander zu verbinden. Das bedeutet dann, dass wir unsere Arbeit um einen "Klick" reduziert haben. Wir haben zwei Knöpfe durch Verkettung auf einen neuen Knopf gelegt. Natürlich klingt die Reduktion um einen Klick vernachlässigbar. Wenn Jedoch diese zwei Klicks 100 mal ausgeführt werden müssen und wir durch logische Anweisung diese ebenfalls auf nur einen Knopf zusammenführen können ist der Zeitgewinn enorm. Ebenfalls muss hier erwähnt werden das viele der Probleme die in einem Gestaltungs-Prozess auftreten nicht zum ersten mal bei eben dieser Person auftreten. Für den Bereich Scripting von Adobe Anwendungen gibt es im Netz viele Seiten und Foren die sich mit diesem Thema befassen. Im Bereich JavaScript gibt es noch viele mehr, da JavaScript auch verwendet wird beziehungsweise entwickelt wurde um Browser zu steuern. Aufgrund dessen ist die Dokumentation mehr als ausgiebig. Es Bedarf nur etwas Übung um die gefundenen Beispiele zu lesen und auf die eigene Problemstellung zu abstrahieren.</p>

<h1>Hierbei sei zu beachten!</h1>

<p>Scripting kann keine Design Entscheidungen fällen. Es existiert kein Algorithmus ([MARGINALSPALTE] Ein Algorithmus ist ein logische Verkettung von Operationen siehe Abschnitt [NUMMER] Was ist ein Algorithmus) der Ästhetik simuliert. Um eine spannende Komposition zu schaffen braucht der Gestalter "nur" drei geometrische Grundformen zu erzeugen und diese im richtigen Verhältnis zu einander anzuordnen. Um dies programmatisch zu lösen müsste ein Skript mehrere hundert mal ausgeführt werden. Jedes mal mit einer kleinen Veränderung der Koordinaten der obig genannten drei Objekte. Davon mal ganz abgesehen, dass der Autor irgendwann entscheiden muss welche Komposition knackig ist. Was das Skript leisten kann ist anhand von bestimmten Rahmenparametern eine Fülle von Varianten zu liefern die von Hand Sehnenscheidenentzündungen hervorrufen würde.<br/>
Programmieren ist nicht einfach. Es ist wie eine neue Sprache lernen. Stellen sie sich vor sie sind in einem fremden Land dessen Sprache sie nicht beherrschen. Sie werden zuerst Probleme haben. Dann lernen sie ihre Grundbedürfnisse zu decken. Ab einem gewissen Punkt können sie Tageszeitungen lesen und Inhalte erfassen und abstrahieren. Eines Tages werden sie feststellen, dass sie in der Sprache Träumen. Der Vorteil an Computersprachen im Vergleich zu "Menschensprachen" ist das in der Computersprache kein Raum für Interpretation ist. Jede Aussage MUSS eindeutig sein. In der Kommunikation mit Menschen MUSS interpretiert werden. Dies ist ein Vorteil, dennoch ist eine Sprache zu lernen keine leichte Aufgabe.<br/>
Daher sollten sie bevor sie in die Tiefen von JavaScript abtauchen um ein Problem zu lösen entscheiden:</p>

<ul>
<li>Welche Operationen sollen ausgeführt werden?</li>
<li>Wie komplex sind die Operationen?</li>
<li>Wie ist das Zeitfenster und wann muss das Produkt fertig sein?</li>
<li>Wie oft muss diese Tätigkeit ausgeführt werden?</li>
<li>Lässt sich die Automation auch auf andere ähnliche Bereiche anwenden oder mit geringen Aufwand abstrahieren?</li>
<li>Wie sehr ist sie von Umgebungsvariablen abhängig?</li>
<li>Soll die Automation von dritten Benutzt werden?</li>
<li>Ist der Prozess linear oder bedarf es einer Rückkopplung zum Benutzer?</li>
</ul>


<p>Und einige Punkte die sich hauptsächlich durch Recherche abarbeiten lassen</p>

<ul>
<li>Existieren bereits Automationen in dem Sektor und wenn ja lassen sich diese abwandeln?</li>
<li>Bietet die API direkten Zugriff auf die benötigten Funktionen oder braucht es eine Workaround?</li>
</ul>


<p>Diese Analyse kann keine genauen Angaben über Zeit und Aufwand machen da dies immer auch vom Erfindungsreichtum des Autors abhängig ist. Der Kreative kommt hier schneller zum Ziel.</p>

<ul>
<li>Welche Operationen sollen ausgeführt werden?</li>
</ul>


<p>Programme oder Skripte schreiben ist nicht wie "Scribbeln". Wir können beim Telefonieren eine Stift in die Hand nehmen und drauf los kritzeln. Beim Programmieren muss das Ergebnis bereits definiert sein bevor geschrieben wird. Natürlich ergeben sich auch während des Schreibens neue Ideen, dennoch muss eine konkreten Vorstellung existieren was das Ziel sein soll. Auch dies ist mit Sprechen zu vergleichen. Erst Denken dann Reden.</p>

<ul>
<li>Wie komplex sind die Operationen?</li>
</ul>


<p>Wenn eine Fülle von unterschiedlichen Operationen ausgeführt werden soll, müssen auch entsprechend viele Anweisungen an das Programm erfolgen und der Autor muss sich auf eine längere Entwicklungszeit einstellen. Wenn es im Gegensatz darum geht eine Hand voll Operationen 1000 mal auszuführen kann es sein, daSs sich der Kern des Skriptes auf 10 Zeile reduziert. DIES bedeutet auch, dasS die Zeit für Entwicklung und Debugging relativ gering sein können und sich der Zeitaufwand lohnen kann.</p>

<ul>
<li>Wie ist das Zeitfenster und wann muss das Produkt fertig sein?</li>
</ul>


<p>Auch hier muss abhängig von der Komplexität des Skriptes und dem eigenem Vermögen geurteilt werden ob dies in dem gegebenen Zeitraum Recherchiert, Entworfen, Geschrieben und "debugged" ([MARGINALSPLATE] Debugging ist der Prozess der Fehlersuche. Siehe Abschnitt [NUMMER] Was ist Debugging?) werden kann. Hinzu kommt, dass das Ergebnis meist nur ein Teilergebnis ist und noch weiterverarbeitet werden muss. Es ist davon auszugehen das etwaige tiefere Fehler erst während des vollem Einsatzes auftreten. Wenn dies in dem entsprechendem Zeitraum nicht zu bewerkstelligen ist sollte von einer Entwicklung abgesehen werden.</p>

<ul>
<li>Wie oft muss diese Tätigkeit ausgeführt werden?</li>
</ul>


<p>Wenn das Skript nur ein einziges mal ausgeführt werden soll, sollte man sich fragen wo darin der Nutzen liegt. Es kann natürlich sein das dies Sinn und Zweck hat und sollte nur bedingt ausschlaggebend sein. Hierbei gilt es zu Unterscheiden das einmalig 1000 mal einen Knopf drücken bereits eine Hilfe sein kann. Einmalig 1000 mal unterschiedliche Knöpfe drücken ist eine Aufgabe die doch besser manuell geschieht.</p>

<ul>
<li>Lässt sich die Automation auch auf andere ähnliche Bereiche anwenden oder mit geringen Aufwand abstrahieren?</li>
</ul>


<p>Wenn dies der Fall ist steigt der Nutzen der Arbeit. Der einmalige Aufwand ein Programm oder Skript für eine immer wieder kehrende beziehungsweise ähnliche Aufgabe zu schreiben reduziert sich im "Nachhinein" durch jede Ausführung. Dies soll heissen: Durch das Schreiben des Programms das ich immer wieder verwende spare ich Zeit in der Zukunft.</p>

<ul>
<li>Wie sehr ist sie (Die Aufgabe) von Umgebungsvariablen abhängig?</li>
</ul>


<p>([MARGINALSPALTE] Das selbstgeschriebene Programm ist in diesem Fall aussen vor. Wie bereits oben erwähnt setzt das Programm alle Möglichkeiten voraus. Das Skript hingegen greift auf bestehende Komponenten zu.) Kann das Skript unabhängig von allen Variablen die der Benutzer setzen kann ausgeführt werden vereinfacht das den Aufwand. Bei einer Abhängigkeit erfordert es immer erst einer Abfrage des "Ist-Status".<br/>
Ein kleines Beispiel: In Illustrator oder InDesign wird die aktuelle Auswahl des aktiven Dokuments in einer Liste genannt "selection" geführt.</p>

<div class="highlight"><pre><code class="js">   <span class="nx">app</span><span class="p">.</span><span class="nx">activeDocument</span><span class="p">.</span><span class="nx">selection</span><span class="o">;</span>
</code></pre>
</div>


<p>In dieser Liste liegen Einzelne Objekte die Text sein können oder eine Vektor-Form oder ein Bild. All diese haben gemeinsame Eigenschaften aber auch spezielle. Es muss also bevor eine Eigenschaft genutzt oder verändert werden kann eine Abfrage stattfinden welche Art von Objekt enthalten ist. Das nachfolgende Beispiel funktioniert in InDesign und Illustrator gleich. Es wird der Name des ersten Objekts in der Selektion abgefragt, wenn dies eine Textkiste ist gibt das Skript eine Meldung zurück.</p>

<div class="highlight"><pre><code class="js">   <span class="c">// InDesign &amp; Illustrator</span>
    <span class="kd">var</span> <span class="nx">firstListItem</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">activeDocument</span><span class="p">.</span><span class="nx">selection</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="c">// first object in selection </span>
        <span class="k">if</span><span class="p">(</span><span class="nx">firstListItem</span> <span class="k">instanceof</span> <span class="nx">TextFrame</span><span class="p">){</span> <span class="c">/* check the type */</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;I am a &quot;</span> <span class="o">+</span> <span class="nx">firstListItem</span><span class="p">.</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>    <span class="c">// and name it</span>
    <span class="p">}</span>
  
</code></pre>
</div>




<br /> <a href="images/ai_id_textframe.png"><img src="images/ai_id_textframe.png" width="100%" alt="" /></a>


<p>Viele solcher Abfrage können ein Skript schnell komplex werden lassen. Oder anders ausgedrückt je universeller der Nutzen sein soll desto mehr Umgebungsvariablen müssen beachtet werden. Dies benötigt Zeit.</p>

<ul>
<li>Soll die Automation von dritten Benutzt werden?</li>
</ul>


<p>Dies ist ein wichtiger Faktor. Wenn nur der Autor selbst die Automation verwendet kann er seine vorhergehenden Aktionen auf die Bedürfnisse und Beschränkungen des Skriptes anpassen. Wenn jedoch eine unbedarfte oder schlimmer noch eine dem Skripten nicht mä(ö)chtige Person dieses Werkzeug nutzen soll müssen wie bereits oben erwähnt viele Umgebungsvariablen abgefragt oder selber bestimmt werden. Im Programmier-Slang sagt man: "Man muss vom DAU* ausgehen." ([MARGINALSPALTE]Dümmster Anzunehmender User). Dies ist nicht als Beleidigung gedacht. Es soll eher sagen dass alle Benutzerfehler die auftreten können auftreten werden. In diesem Fall bekommt ein Nicht des Programmierens Mächtiger wenn er Glück hat nur eine Fehlermeldung, wenn er Pech hat einen Programmabsturz. In beiden Fällen steigt die Hemmung des Nutzer ungemein das Skript noch einmal zu verwenden. Wenn also Dritte mit ins Spiel kommen erfordert es noch längere Test- und Debug-Phasen.</p>

<ul>
<li>Ist der Prozess linear oder bedarf es einer Rückkopplung zum Benutzer?</li>
</ul>


<p>Wenn dem so ist sollte der Prozess vielleicht in mehrere Skripte zerlegt werden. Für den Fall das Variablen von einem Skript an das nächste übergeben werden müssen kann dies die Komplexität weiter erhöhen. In diesem Fall gibt es die Möglichkeit eigene Textdateien vom Skript kreieren zu lassen in dem Werte abgelegt werden können, Eine "Script Panel" ([MARGINALSPALTE] Ein Script Panel ist eine Erweiterung der Grafischen Oberfläche die es erlaubt während das Skript läuft weiterhin mit dem Programm zu interagieren) zu erzeugen oder eine eigene <code>#targetengine</code> zu erzeugen in der solange das Programm aktiv ist Daten gespeichert werden. Die letzten beiden sind jedoch fortgeschrittene Lösungen die ebenfalls viele Stolpersteine beherbergen können.</p>

<h4>Das Beispiel targetengine</h4>

<p>Skript 1:</p>

<div class="highlight"><pre><code class="js">   <span class="err">#</span><span class="nx">targetengine</span> <span class="s2">&quot;session01&quot;</span>
    <span class="kd">var</span> <span class="nx">myValue</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="c">// new value</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">myValue</span><span class="p">);</span> <span class="c">// result is 0</span>
    <span class="nx">myValue</span><span class="o">++;</span> <span class="c">// increment by 1</span>
</code></pre>
</div>


<p>Skript 2:</p>

<div class="highlight"><pre><code class="js">   <span class="err">#</span><span class="nx">targetengine</span> <span class="s2">&quot;session01&quot;</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">myValue</span><span class="p">);</span> <span class="c">// result is 1</span>
</code></pre>
</div>


<p>Der Algorithmus lautet wie folgt</p>

<div class="highlight"><pre><code class="js">   <span class="nx">Start</span>  
    <span class="nx">Sitzung</span> <span class="mi">1</span>
    <span class="nx">definiere</span> <span class="nx">Variable</span> <span class="nx">meinWert</span> <span class="nx">und</span> <span class="nx">Speicher</span> <span class="mi">0</span> <span class="k">in</span> <span class="nx">ihr</span>
    <span class="nx">zeige</span> <span class="nx">Wert</span> <span class="nx">von</span> <span class="nx">meinWert</span>
    <span class="nx">erh</span><span class="err">ö</span><span class="nx">he</span> <span class="nx">meinWert</span> <span class="nx">im</span> <span class="nx">eins</span>
    <span class="nx">Stop</span>  
  
    <span class="nx">Start</span>  
    <span class="nx">Sitzung</span> <span class="mi">1</span>
    <span class="nx">zeige</span> <span class="nx">Wert</span> <span class="nx">von</span> <span class="nx">meinWert</span>
    <span class="nx">Stop</span>  
</code></pre>
</div>


<p>Dies bedeutet dass das Programm (nicht das Skript) sich den Wert für die Variable <code>myValue</code> gemerkt hat und ihn solange in <code>#targetengine "session01"</code> speichert bis es beendet wird. Hier liegt die Gefahr darin Variablen Namen doppelt zu vergeben. In vielen meiner Skripte speichere ich das aktive Dokument in der variable <code>doc</code>. Wenn diese nun in einer targetengine liegen wird das Programm immer auf das zuletzt <code>doc</code> gleichgesetzte Objekt zugreifen auch wenn dies vielleicht nicht gewünscht ist sondern vom Benutzer nicht beachtet wurde. Auch die Verwendung von Textdateien kann ihre Tücken haben. Auf unterschiedlichen Betriebsystemen werden Dateipfade unterschiedlich gehandhabt. Auch dies will abgefragt und getestet werden. "Last but not least" gibt es noch die Möglichkeit eigene Grafische Benutzeroberflächen zu erzeugen. Dies ist aber eine Variante für erfahrenere Autoren.</p>

<p>Die Recherche-Arbeiten sollten bereits vor dem ersten Entwurf erledigt sein.</p>

<ul>
<li>Existieren bereits Automationen in dem Sektor und wenn ja lassen sich diese abwandeln?</li>
</ul>


<p>Wie bereits oben erwähnt sind viele Probleme bereits einmal aufgetreten am Ende dieser Arbeit ist eine Liste zu finden wo für welchen Zweck nach Informationen gesucht werden kann. Wenn das Problem nicht all zu speziell ist kann es gut sein, dass es bereits ein Skript gibt das entweder genau diese Funktion enthält und wenn nicht auf die eigenen Bedürfnisse angepasst werden kann oder was meist der Fall es mehrere Skripte gibt die Teilprozesse der eigenen Idee beinhalten und als Referenz benutzt werden können. In den seltensten Fällen entsteht ein Skript von Scratch*(aus einem blanken Textdokument).</p>

<ul>
<li>Bietet die API direkten Zugriff auf die benötigten Funktionen oder bedarf es eines Workaround?</li>
</ul>


<h4>Das Beispiel try char</h4>

<p>Um dies zu erläutern möchte ich mich eines Beispiels bedienen.<br/>
InDesign kann nicht erfragen ob ein Zeichen in einer Schriftart enthalten ist. Es gibt kein Feld das so etwas <code>wie Font has Character</code> beinhaltet. Um dieses Abfrage zu simulieren hat Peter Kahrel ([MARGINALSPALTE] Peter Kahrel ist einer der präsentesten InDesign Skripter und Autor von "InDesign mit JavaScript automatisieren" im O'Reilly Verlag) die Funktion try_char geschrieben die hier in einer etwas abgewandelten Form folgt.</p>

<br /> <a href="images/algorithmus_trychar.png"><img src="images/algorithmus_trychar.png" width="100%" alt="" /></a>


<p>Um die folgende Funktion <code>try_char()</code> sinnvoll ausführen zu können benötigen sie ein InDesign Dokument mit einer Textbox auf der ersten Seite, in der Text in einer Schriftart enthalten ist die die Zeichen des Textes nicht enthält.</p>

<div class="highlight"><pre><code class="js">   <span class="kd">var</span> <span class="nx">tf</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">activeDocument</span><span class="p">.</span><span class="nx">pages</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">textFrames</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
 
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">tf</span><span class="p">.</span><span class="nx">characters</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
     <span class="kd">var</span> <span class="nx">theChar</span> <span class="o">=</span> <span class="nx">tf</span><span class="p">.</span><span class="nx">characters</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
     <span class="nx">try_char</span> <span class="p">(</span><span class="nx">theChar</span><span class="p">);</span>
     <span class="p">};</span>
 
    <span class="c">// original function by Peter Kahrel </span>
    <span class="c">// http://www.kahrel.plus.com/indesign/compose_cs3.jsx</span>
    <span class="c">// edited by fabiantheblind</span>
    <span class="kd">function</span> <span class="nx">try_char</span> <span class="p">(</span><span class="nx">theChar</span><span class="p">){</span>  
    <span class="k">try</span> <span class="p">{</span>  
        <span class="c">// save the character </span>
        <span class="kd">var</span> <span class="nx">storage</span> <span class="o">=</span> <span class="nx">theChar</span><span class="p">.</span><span class="nx">contents</span><span class="o">;</span> 
        <span class="c">// create outline  </span>
        <span class="nx">theChar</span><span class="p">.</span><span class="nx">createOutlines</span><span class="p">();</span>  
        <span class="c">// if we got here it worked, so delete the outline</span>
        <span class="c">// if not the next line will be within the catch block  </span>
        <span class="c">// if not it will cause an error  </span>
        <span class="nx">theChar</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>  
        <span class="c">// insert the character (again)  </span>
        <span class="nx">theChar</span><span class="p">.</span><span class="nx">contents</span> <span class="o">=</span> <span class="nx">storage</span><span class="o">;</span>  
        <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>  
        <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;The character &quot;</span><span class="o">+</span> <span class="nx">theChar</span><span class="p">.</span><span class="nx">contents</span> <span class="o">+</span> 
        <span class="s2">&quot; could not be converted into an Outline.\n&quot;</span><span class="o">+</span>
        <span class="s2">&quot;That means he does not exist in the font:\n\&quot;&quot;</span>
        <span class="o">+</span> <span class="nx">theChar</span><span class="p">.</span><span class="nx">appliedFont</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s2">&quot;\&quot;&quot;</span><span class="p">);</span>
        <span class="p">}</span>  
     <span class="p">}</span> 
 
</code></pre>
</div>




<br /> <a href="images/try_char_id.png"><img src="images/try_char_id.png" width="100%" alt="" /></a>


<p>Diese Funktion macht folgendes. Sie bekommt eine Zeichen als Parameter. Diesen speichert sie temporär in einer Variable. Dann wird das Zeichen genommen und InDesign versucht es in Pfade umzuwandeln. Dies kann nur passieren wenn das Zeichen in der Schrift auch existiert. Sollte dem so sein wird die neu kreierte Vektor-Form wieder verworfen und das Zeichen wird aus dem Zwischenspeicher wieder hergestellt. Wenn jedoch die Umwandlung einen Fehler erzeugt wird dieser aufgefangen. Dies passiert mit dem Konstrukt <code>try { } catch (e) { }</code> Sollte der Inhalt der ersten geschwungenen Klammer oder auch Block genannt einen Fehler erzeugen wird dieser abgebrochen und das Skript führt den Zweiten Block aus. Die Variable <code>e</code> ist in diesem Fall die Fehlermeldung. Probieren sie es  mit diesem kurzen Skript aus.</p>

<div class="highlight"><pre><code class="js"><span class="k">try</span><span class="p">{</span>
    <span class="kd">var</span> <span class="nx">no_no</span> <span class="o">=</span> <span class="nx">nothing</span><span class="o">;</span> <span class="c">// nothing does not exist</span>
    <span class="c">// so this produces an error</span>

<span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="c">// open a window and show the alert.</span>
    <span class="c">// \n is just a breakline</span>
    <span class="c">// \&quot; is to show quotation marks in text</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;This is the error message \&quot;e\&quot;:\n&quot;</span> <span class="o">+</span> <span class="nx">e</span><span class="p">);</span>
    <span class="p">}</span>
</code></pre>
</div>




<br /> <a href="images/trycatchscript.png"><img src="images/trycatchscript.png" width="100%" alt="" /></a>


<p>Das Programm wird sie warnen das die Variable <code>nothing</code> nicht existiert.<br/>
Solche Lösungen setzen nicht nur ein kreativen Umgang mit Code voraus sondern auch ein tiefes Wissen über die Funktionsweise und Möglichkeiten innerhalb von, in diesem Falle, InDesign.<br/>
Die obig genannten Hindernisse schrecken ab. Es klingt alles sehr komplex. Es ist jedoch alles sehr allgemein gehalten und manche Fragen stelle sich auch erst gar nicht. Bei Aufgaben die ein Normal Nutzer niemals manuell machen würde muss sogar ein Skript geschrieben werden wenn sie erledigt werden sollen.<br/>
Auch wenn der Prozess des Skript-Schreibens eine Kreative Arbeit ist, ist das Ziel des Skriptes nicht der Kreative Output sondern die Optimierung der eigenen Arbeitsabläufe. Das Skript oder Programm kann niemals die Idee liefern. Es unterstützt den Prozess indem es sich wiederholende  Aufgaben erledigt die entweder niemals gemacht worden wären, oder aber vom eigentlichen Kreativem Prozess ablenken.</p>

<br />


<h2>Teil XX Das Szenario</h2>

<p>Um besser zu verstehen was das Skript leisten kann soll hier ein Fall Beispiel aufgemacht werden vor dem jeder Layouter einmal stehen könnte. Stellen sie sich vor ihre Aufgabe ist folgende:</p>

<br>


<p>Erzeugen Sie eine quadratische Bildmatrix in InDesign aus einer definierten Anzahl an quadratischen Bildern mit einer festen Grösse.</p>

<br>


<p>Das würde bedeuten das wir zum Beispiel 4×4 also 16 Bilder darstellen wollen.
Es folgt eine grafische Gegenüberstellung des automatisierten (links) und manuellen (rechts) Prozesses.</p>

<br /> <a href="images/matrix_algorithmus_01.png"><img src="images/matrix_algorithmus_01.png" width="100%" alt="" /></a>


<p>Wird ihnen bereits klar worauf ich hinaus will? Bei 16 Bildern kommen wir auf 38 Aktionen. Mit einem Skript haben wir 3 Aktionen. Wenn es eine 10×10 Matrix sein soll sind das 206 Aktionen im Skript sind es weiterhin 3. Der Kern der Aufgabe ist das errechnen des Layouts. Dies muss in der manuellen sowie in der automatisierten Variante passieren. Also kommt auch der Gestalter der sich für die manuelle entschieden hat auch nicht um etwas Mathematik herum. Da wir von Prozessen im Gestalter Alltag reden kann es gut vorkommen das ein Kunde eine solche Aufgabe an sie stellt.<br/>
Verändern wir die Aufgabe noch ein wenig:<br/>
Erzeugen Sie eine Bildmatrix in InDesign aus einer noch nicht definierten Anzahl an quadratischen Bildern mit einer festen Grösse.</p>

<br /> <a href="images/matrix_algorithmus_02.png"><img src="images/matrix_algorithmus_02.png" width="100%" alt="" /></a>  


<p>Um dieser Anforderung gerecht zu werden müssen wir in der automatisierten Variante eine Kondition einführen. Wenn die gerundete Wurzel eine Fließkommazahl ist, ist die Seitenhöhe die Seitenbreite plus eine Bildbreit.</p>

<br />


<h2>Teil 3 Der Einsatz</h2>

<p>Die Fragen die sich jetzt stellen sind folgende: "Wie kommt dies zum Einsatz?", "Wie kann ich dies nutzen?".
Es folgt nun das InDesign Skript image_matrix.jsx mit etwas mehr als 40 Zeilen Code. Dieses Skript beinhaltet eine Benutzer Interaktion, Dateihandhabung, das Math Objekt ([MARGINALSPLATE] Das Math Objekt ist ein ein bereits bestehender Teil von JavaScript. Es erledigt solche Aufgaben wie Rundung von Werten oder das Berechnen einer Quadratwurzel), Konditionen, eine Schleife, Funktionen, Variablen und es hat einen generativen Charakter. Das Skript erledigt folgende Schritte.</p>

<ul>
<li>Frage den Benutzer nach einem Ordner mit jpg Dateien.</li>
<li>Erzeuge ein Quadratisches Dokument dessen Grösse auf der Quadratwurzel der Menge der Bilder basiert und alle Bilder fast.</li>
<li>Platziere alle Bilder.</li>
</ul>


<p>Kopieren sie den nachstehenden Code und bereiten sie einen Ordner mit einigen Jpg-Bildern vor. Das Skript das unten beschrieben wird verarbeitet NUR .jpg Dateien, Dateien die .jpeg oder .JPG heissen werden ignoriert. Es sollten um die 15 bis 30 sein damit die Ausführung des Skriptes nicht zuviel Zeit in Anspruch nimmt. Es kann jedoch auch 100, 1000 oder mehr Bildern verarbeiten. Die genau Menge ist irrelevant. Lesen sie nochmal den Abschnitt [NUMMER] Hello World  und führen sie das Skript aus. Wenn der Ordnerauswahl Dialog sich öffnet wähle sie den Ordner mit den Bildern.
Das gesamte Skript:</p>

<div class="highlight"><pre><code class="js">   <span class="p">{</span> <span class="c">// START SCRIPT</span>
    <span class="nx">main</span><span class="p">();</span> <span class="c">// you need a function to be able to cancel a script</span>

    <span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span> <span class="c">// all is in here</span>

    <span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">25</span><span class="o">;</span> <span class="c">// the image sizes</span>
    <span class="kd">var</span> <span class="nx">allImages</span> <span class="o">=</span> <span class="nx">loadFiles</span><span class="p">(</span><span class="s2">&quot;*.jpg&quot;</span><span class="p">);</span> <span class="c">// opens a prompt and lets the user choose a folder</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">allImages</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span><span class="o">;</span> <span class="c">// if that what the function returns null is - cancel</span>

    <span class="kd">var</span> <span class="nx">pw</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">allImages</span><span class="p">.</span><span class="nx">length</span><span class="p">))</span> <span class="o">*</span> <span class="nx">w</span> <span class="o">+</span> <span class="p">(</span><span class="nx">w</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span> <span class="c">// this will hold the page width</span>
    <span class="kd">var</span> <span class="nx">ph</span> <span class="o">=</span> <span class="nx">pw</span><span class="o">;</span>

    <span class="k">if</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">allImages</span><span class="p">.</span><span class="nx">length</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">allImages</span><span class="p">.</span><span class="nx">length</span><span class="p">)){</span>
            <span class="nx">ph</span> <span class="o">=</span> <span class="nx">pw</span> <span class="o">+</span> <span class="nx">w</span><span class="o">;</span>
            <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">doc</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">documents</span><span class="p">.</span><span class="nx">add</span><span class="p">();</span> <span class="c">//build a basic document</span>
    <span class="nx">doc</span><span class="p">.</span><span class="nx">documentPreferences</span><span class="p">.</span><span class="nx">pageWidth</span> <span class="o">=</span> <span class="nx">pw</span><span class="o">;</span> <span class="c">// set the width</span>
    <span class="nx">doc</span><span class="p">.</span><span class="nx">documentPreferences</span><span class="p">.</span><span class="nx">pageHeight</span> <span class="o">=</span> <span class="nx">ph</span><span class="o">;</span> <span class="c">// set the height</span>
    <span class="kd">var</span> <span class="nx">page</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">pages</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="c">// finally - get the first page</span>

    <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">w</span><span class="o">;</span> <span class="c">// the upper left corner</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">w</span><span class="o">;</span> <span class="c">// the upper left corner</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">allImages</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span> <span class="c">// loop thru all images</span>

    <span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="nx">page</span><span class="p">.</span><span class="nx">rectangles</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span><span class="nx">geometricBounds</span><span class="o">:</span><span class="p">[</span><span class="nx">y</span><span class="o">,</span><span class="nx">x</span><span class="o">,</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">w</span><span class="o">,</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">w</span><span class="p">]});</span> <span class="c">// add a rectangle to the page</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">place</span><span class="p">(</span><span class="nx">allImages</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">);</span> <span class="c">// place the image</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">fit</span><span class="p">(</span><span class="nx">FitOptions</span><span class="p">.</span><span class="nx">FILL_PROPORTIONALLY</span><span class="p">);</span> <span class="c">// fit it to the frame</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">fit</span><span class="p">(</span><span class="nx">FitOptions</span><span class="p">.</span><span class="nx">CENTER_CONTENT</span><span class="p">);</span> <span class="c">// fit it to the frame</span>
    <span class="nx">x</span> <span class="o">+=</span><span class="nx">w</span><span class="o">;</span> <span class="c">// increase x by an image width</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">x</span> <span class="o">&gt;=</span> <span class="nx">pw</span> <span class="o">-</span> <span class="p">(</span><span class="nx">w</span><span class="p">)){</span> <span class="c">// if x is the width minus an image width</span>
            <span class="nx">x</span> <span class="o">=</span> <span class="nx">w</span><span class="o">;</span> <span class="c">// reset x</span>
            <span class="nx">y</span><span class="o">+=</span> <span class="nx">w</span><span class="o">;</span> <span class="c">// and increment y by an image width</span>
            <span class="p">};</span> <span class="c">//end increase x and y conditional</span>

        <span class="p">};</span><span class="c">//close allImages loop</span>

    <span class="p">};</span><span class="c">// end main function</span>

    <span class="kd">function</span> <span class="nx">loadFiles</span><span class="p">(</span><span class="nx">type</span><span class="p">){</span> <span class="c">// the function that loads the files</span>

    <span class="kd">var</span> <span class="nx">theFolder</span> <span class="o">=</span> <span class="nx">Folder</span><span class="p">.</span><span class="nx">selectDialog</span> <span class="p">(</span><span class="s2">&quot;Choose the Folder&quot;</span><span class="p">);</span><span class="c">// user select a folder</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">theFolder</span><span class="p">){</span> <span class="c">// if the folder is not a folder cancel the script</span>
        <span class="k">return</span><span class="o">;</span> <span class="c">// this cancels the whole function image_loadFiles</span>
            <span class="p">};</span> <span class="c">// end folder check</span>

    <span class="kd">var</span> <span class="nx">allImages</span> <span class="o">=</span> <span class="nx">theFolder</span><span class="p">.</span><span class="nx">getFiles</span><span class="p">(</span><span class="nx">type</span><span class="p">);</span><span class="c">// get the files by type</span>
    <span class="k">if</span><span class="p">((</span><span class="nx">allImages</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">||</span><span class="p">(</span><span class="nx">allImages</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">){</span><span class="c">// again if check if there are images</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;There are no images of the type: &quot;</span> <span class="o">+</span> <span class="nx">type</span><span class="p">);</span><span class="c">// hm something went wrong? User error</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span> <span class="c">// so we cancel the function</span>
           <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="k">return</span> <span class="nx">allImages</span><span class="o">;</span> <span class="c">// give back the images. Success!</span>
            <span class="p">};</span><span class="c">// end all images check</span>

        <span class="p">};</span><span class="c">// end function loadFiles</span>
    <span class="p">}</span> <span class="c">// END OF SCRIPT</span>
</code></pre>
</div>




<br>


<h4>Ergebnisse image_matrix.jsx</h4>

<p>Alle 3 nachfolgenden Bilder sind mit ein und dem selbem Skript erzeugt.</p>

<br /> <a href="images/image_matrix_1.jpg"><img src="images/image_matrix_1.jpg" width="100%" style="max-width:500px;" alt="" /></a><br />


<br /> <a href="images/image_matrix_2.jpg"><img src="images/image_matrix_2.jpg" width="100%" style="max-width:500px;" alt="" /></a><br />


<br /> <a href="images/image_matrix_3.jpg"><img src="images/image_matrix_3.jpg" width="100%" style="max-width:500px;" alt="" /></a><br />


<h3>image matrix Schritt für Schritt.</h3>

<p>Ein Skript sollte immer in geschwungenen Klammern eingefasst sein. Dies ist nicht zwingend jedoch nützlich falls das Skript von einem anderem Skript evaluiert werden muss. Innerhalb dieser Klammern folgt der gesamte Quelltext.</p>

<pre><code>{}
</code></pre>

<p>Als nächstes definieren wir eine Funktion die einmalig aufgerufen wird. Hierbei ist es irrelevant ob der Aufruf vor oder nach der Funktionsdefinition stattfindet. Aus Gründen der Übersichtlichkeit steht hier der Aufruf vor der Definition. Diese Funktion erhält keine Parameter. Später wird auch ein Funktion mit Parametern eingesetzt. Der Zweck den gesamten Code in einer Funktion zu kapseln ist folgender: Wenn es eine hierarchisch höhere Ebene gibt, unsere <code>{}</code> Klammern, kann eine Funktion mit dem Befehl <code>return;</code> beendet werden. Dies ist nützlich um bei Fehlern oder falscher Benutzer Eingabe die Ausführung zu stoppen. Mit dem Befehl <code>return</code> kann nicht nur ein Funktion beendet werden sondern auch ein Wert zurückgeliefert werden.<br/>
Wenn wir also schreiben <code>return 1;</code> am Ende einer Funktion wäre das Ergebnis 1. <code>var myValue = main();</code> Wenn die Funktion main nun einen Wert zurückgeben würde, wäre <code>myValue</code> 1. In unserem Fall benötigt die <code>main()</code> keinen Rückgabewert.</p>

<div class="highlight"><pre><code class="js">   <span class="nx">main</span><span class="p">();</span>
    <span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span>
    <span class="p">}</span>
</code></pre>
</div>


<p>Wir befinden uns nun in der Funktion <code>main();</code>.<br/>
Es folgt die Deklaration der ersten Variable. Sie beinhaltet die Breite (und Höhe) unserer Bilder.</p>

<div class="highlight"><pre><code class="js">   <span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">25</span><span class="o">;</span>
</code></pre>
</div>


<p>Wie zu sehen ist entspricht die Variable <code>w</code>*(steht für width) nun 25. <code>w</code> wird im Verlauf des Skriptes mehrmals verwendet. Der Vorteil  daran Variablen zu verwenden anstatt immer 25 zu schreiben ist, dass wenn wir die Breite verändern wollen wir dies nur ein einziges mal an <code>w</code> erledigen müssen und alle weiteren Verwendungen von <code>w</code> werden angepasst.<br/>
Als nächstes folgt bereits die nächste Subfunktion mit einem Parameter und einem Rückgabewert. In JavaScript werden alle Variablen mit <code>var</code> deklariert. Die Unterscheidung des Typus findet erst bei der Verwendung statt. Deshalb können wir schreiben.</p>

<div class="highlight"><pre><code class="js">   <span class="kd">var</span> <span class="nx">allImages</span> <span class="o">=</span> <span class="nx">loadFiles</span><span class="p">(</span><span class="s2">&quot;*.jpg&quot;</span><span class="p">);</span>
</code></pre>
</div>


<p>Damit die Funktion auch vorhanden ist fügen wir sie hinter <code>function main(){ }</code> an.
Unser Code sieht also wie folgt aus.</p>

<div class="highlight"><pre><code class="js">   <span class="p">{</span>
    <span class="nx">main</span><span class="p">();</span>
        <span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span>
            <span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">25</span><span class="o">;</span>
            <span class="kd">var</span> <span class="nx">allImages</span> <span class="o">=</span> <span class="nx">loadFiles</span><span class="p">(</span><span class="s2">&quot;*.jpg&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">loadFiles</span><span class="p">(</span><span class="nx">type</span><span class="p">){</span>
            <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
</div>


<p>Den Rückgabewert werden wir noch verändern, denn wir wollen Bilder laden und nicht 0. Wie oben zu sehen ist erhält <code>loadFiles</code> den Parameter <code>type</code>. Dies ist der Dateityp der später geladen werden soll. <code>type</code> ist genau wie <code>w</code> und <code>allImages</code> eine Variable nur das wir im Parameter Block der Funktion das <code>var</code> weglassen können.<br/>
Wenn wir <code>*.*</code> schreiben würden würde unsere Funktion jeden Dateityp laden. Der Einfachheit halber beschränken wir uns auf jpg da wir wissen das InDesign jpg-Dateien laden und platzieren kann.<br/>
Als nächstes begeben wir uns in die Funktion <code>loadFiles</code> und betrachten die Dateihandhabung und eine Benutzerinteraktion. Basierend auf dem Ergebnis der Interaktion fällt das Skript eine Konditionale Entscheidung ob es weiter arbeiten soll oder ob es die Funktion <code>loadFiles</code> beendet.</p>

<div class="highlight"><pre><code class="js">   <span class="kd">var</span> <span class="nx">theFolder</span> <span class="o">=</span> <span class="nx">Folder</span><span class="p">.</span><span class="nx">selectDialog</span> <span class="p">(</span><span class="s2">&quot;Choose the Folder&quot;</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">theFolder</span><span class="p">){</span> 
            <span class="k">return</span><span class="o">;</span>
            <span class="p">};</span>
</code></pre>
</div>


<p>Bisher waren alle Befehle JavaScript Befehle. Der Befehl <code>Folder.selectDialog ("Choose the Folder")</code> jedoch ist ExtendScript. das Objekt <code>Folder</code> hat eine eigene Funktion <code>selectDialog(parameter)</code>. Wir müssen diese Funktion nicht betrachten. Wir müssen nur wissen, dass sie ein Interface öffnet und dem Benutzer die Möglichkeit gibt einen beliebigen Ordner auszuwählen. Der Parameter ist der Text der auf dem Auswahldialog oben zu sehen ist. Der gewählte Ordner wird dann in der neuen Variable <code>theFolder</code> für eine spätere Referenzierung gespeichert. Dann folgt das Konstrukt der Konditionalen Abfrage.</p>

<div class="highlight"><pre><code class="js">   <span class="k">if</span><span class="p">(</span> <span class="nx">Statement</span> <span class="p">){</span> <span class="nx">Do</span> <span class="nx">Something</span> <span class="p">}</span>
</code></pre>
</div>


<p>Sie besagt, dass wenn die Aussage in der runden Klammer war ist die geschwungene Klammer ausgeführt wird. in unserem Fall wird durch das <code>!</code> die Aussage negiert. Ausgeschrieben könnte dort stehen <code>if(theFolder == false)</code> oder <code>if(theFolder != true)</code> die Schreibweise <code>if(!theFolder)</code> ist einfach nur verkürzt. Wenn wir  <code>if(theFolder)</code> schreiben würden würde das <code>if(theFolder==true)</code> entsprechen. Zu Beachten ist nicht <code>=</code> zu schreiben. Dies bedeutet "ist gleich", <code>==</code> bedeutet "entspricht". Gesprochen wäre unsere Aussage: "Wenn der Ordner nicht existiert - beende die Funktion".<br/>
Als nächstes betrachten wir was das Laden der Dateien aus unserem Ordner.</p>

<div class="highlight"><pre><code class="js">   <span class="kd">var</span> <span class="nx">allImages</span> <span class="o">=</span> <span class="nx">theFolder</span><span class="p">.</span><span class="nx">getFiles</span><span class="p">(</span><span class="nx">type</span><span class="p">);</span>
</code></pre>
</div>


<p>Ordner Objekte (Folder) haben eine weiter eingebaute Funktion: <code>getFiles(parameter)</code>. Diese hat auch einen Parameter. Den Dateityp. Hierbei wird nicht nur eine einzelne Datei zurückgegeben sondern eine Sammlung aller Dateien des angegebenen Typs. Dies ist ein Array. Ein Array sollte man sich als eine Liste vorstellen deren Positionen über einen Index aufgerufen werden können. Hierbei ist zu beachten das das erste Objekt in der Liste nicht mit 1 sondern mit 0 angesprochen wird. Also ist <code>allImages[0]</code> das erste Bild unserer Liste.<br/>
Nun folgt ein weitere Sicherheitscheck ob wir Bilder gefunden haben und die Bestimmung des Rückgabewerts unserer Funktion. Ebenfalls wird der Nutzer wenn es keine Bilder gibt darauf hingewiesen.</p>

<div class="highlight"><pre><code class="js">   <span class="k">if</span><span class="p">((</span><span class="nx">allImages</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nx">allImages</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">){</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;There are no images of the type: &quot;</span> <span class="o">+</span> <span class="nx">type</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>     
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="k">return</span> <span class="nx">allImages</span><span class="o">;</span>
    <span class="p">};</span>
</code></pre>
</div>


<p>Wie wir oben sehen benutzen wir nochmals die Konditionale Entscheidung <code>if()</code>. jedoch mit einer Erweiterung dem <code>else</code>. Dies bedeutet das auf jeden Fall eine er beiden Blöcke ausgeführt wird. Um es im Pseudocode darzustellen:</p>

<div class="highlight"><pre><code class="js"><span class="nx">Wenn</span> <span class="nx">die</span> <span class="nx">Aussage</span> <span class="nx">zutrifft</span> <span class="nx">mach</span> <span class="nx">dies</span> <span class="nx">ansonsten</span> <span class="nx">mach</span> <span class="nx">dass</span>
</code></pre>
</div>


<p>Innerhalb unsere runden Aussage Klammer haben wir mehrere Aussagen verknüpft. wir haben also 2 Aussagen. Mit dem <code>||</code> sagen wir entweder oder. In unserem Fall ist das einmal der Check ob wir mindestens ein Bild haben <code>(allImages.length &lt; 1)</code>. <code>length</code> ist eine Eigenschaft jedes Arrays und gibt wenn wir ein Bild haben 1 zurück. Wenn es einhundert sind 100. Wir fragen also ob die länge von unserer Liste kleiner als 1 ist. Diese Aussage verbinden wir mit <code>||</code> dies bedeutet "oder". Wenn also Aussage 1 oder Aussage 2 zutreffen führe den ersten Block aus. Wenn wir beide Aussagen Abfragen wollten müssten wir <code>&amp;&amp;</code> schreiben. Dies würde nur den ersten Block ausführen wenn beide Aussagen zutreffen. In unserem zweiten Aussage fragen wir nach <code>null</code>, dies ist etwas ähnliches wie nichts. Also wenn wir einen Fehler beim Laden der Bilder hatten oder <code>allImages</code> nicht existiert. Im ersten Block beenden wir nur die Funktion. Wenn keine der beiden Aussagen zutrifft sollten wir eine Liste von Bildern haben und diese geben wir mit <code>return allImages</code> an unsere Funktion <code>main</code> zurück.</p>

<p>Wir befinden uns wieder in der Funktion main und werden einen weiter Abfrage starten.</p>

<div class="highlight"><pre><code class="js"><span class="k">if</span><span class="p">(</span><span class="nx">allImages</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span><span class="o">;</span>
</code></pre>
</div>


<p>Wenn <code>loadImages</code> <code>null</code> zurückgibt bricht das Skript ab. Dies ist nötig da <code>loadImages</code> in der Funktion <code>main</code> stattfindet. Also führt ein <code>return</code> in <code>loadImages</code> nur zurück nach <code>main</code> und nicht zum beenden des Skripts. Hier ist ebenfalls eine verkürzte Schreibweise zu sehen. Wir können uns die geschwungenen Klammern sparen wenn wir nur einen einzigen Befehl haben. Das heisst:</p>

<div class="highlight"><pre><code class="js">   <span class="k">if</span><span class="p">(</span><span class="nx">statement</span><span class="p">){</span><span class="nx">doSomething</span><span class="o">;</span><span class="p">}</span> 
</code></pre>
</div>


<p>entspricht:</p>

<div class="highlight"><pre><code class="js">   <span class="k">if</span><span class="p">(</span><span class="nx">statement</span><span class="p">)</span> <span class="nx">doSomething</span>
</code></pre>
</div>


<p>Ebenfalls könnte</p>

<div class="highlight"><pre><code class="js">   <span class="k">if</span><span class="p">(</span><span class="nx">statement</span><span class="p">){</span><span class="nx">doSomething</span><span class="o">;</span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="nx">doSomethingElse</span><span class="o">;</span><span class="p">}</span>
</code></pre>
</div>


<p>als</p>

<div class="highlight"><pre><code class="js">   <span class="k">if</span><span class="p">(</span><span class="nx">statement</span><span class="p">)</span> <span class="nx">doSomething</span><span class="o">;</span> <span class="k">else</span> <span class="nx">doSomethingElse</span><span class="o">;</span>
</code></pre>
</div>


<p>abgekürzt werden. Dies geht jedoch nur bei jeweils einem Befehl nach der Aussage.</p>

<p>Als nächstes folgt die Berechnung unserer Seitenbreite und Seitenhöhe. Die Höhe wird nochmals mit einer Kondition überprüft. Wenn die Menge an Bildern nicht in ein Matrix passt, also 3 mal 3 oder 4 mal 4 oder 100 mal 100 muss die Höhe nochmals um eine Zeile erweitert werden. Hier kommt das JavaScript Objekt <code>Math</code> zum Einsatz.</p>

<div class="highlight"><pre><code class="js">   <span class="kd">var</span> <span class="nx">pw</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">allImages</span><span class="p">.</span><span class="nx">length</span><span class="p">))</span> <span class="o">*</span> <span class="nx">w</span> <span class="o">+</span> <span class="p">(</span><span class="nx">w</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">ph</span> <span class="o">=</span> <span class="nx">pw</span><span class="o">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">allImages</span><span class="p">.</span><span class="nx">length</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">allImages</span><span class="p">.</span><span class="nx">length</span><span class="p">)){</span>
            <span class="nx">ph</span> <span class="o">=</span> <span class="nx">pw</span> <span class="o">+</span> <span class="nx">w</span><span class="o">;</span>
    <span class="p">}</span>
</code></pre>
</div>


<p>Dies wirkt kompliziert. Um es zu Verstehen lösen wir den ersten Satz einmal auf. Betrachten sie das Bild dabei.</p>

<div class="highlight"><pre><code class="js">   <span class="nx">a</span> <span class="nx">ist</span> <span class="nx">gleich</span> <span class="mi">16</span><span class="p">.</span> <span class="nx">Die</span> <span class="nx">Menge</span> <span class="nx">an</span> <span class="nx">Bildern</span><span class="p">.</span>  
    <span class="nx">b</span> <span class="nx">ist</span> <span class="nx">die</span> <span class="nx">Wurzel</span> <span class="nx">aus</span> <span class="nx">a</span><span class="p">.</span> <span class="nx">Wir</span> <span class="nx">wollen</span> <span class="nx">es</span> <span class="nx">rechteckig</span><span class="p">.</span> <span class="nx">Also</span> <span class="mi">4</span><span class="p">.</span>  
    <span class="nx">c</span> <span class="nx">ist</span> <span class="nx">b</span> <span class="nx">gerundet</span><span class="p">.</span> <span class="nx">Falls</span> <span class="nx">es</span> <span class="nx">eine</span> <span class="nx">Gleitkommazahl</span> <span class="nx">ist</span><span class="p">.</span> <span class="nx">Bleibt</span> <span class="k">in</span> <span class="nx">diesem</span> <span class="nx">Fall</span> <span class="mi">4</span><span class="o">,</span> <span class="nx">wenn</span> <span class="nx">a</span> <span class="mi">16</span> <span class="nx">ist</span><span class="p">.</span>
    <span class="nx">d</span> <span class="nx">ist</span> <span class="mi">25</span><span class="p">.</span> <span class="nx">Die</span> <span class="nx">Breite</span> <span class="nx">der</span> <span class="nx">Bilder</span><span class="p">.</span>  
    <span class="nx">e</span> <span class="nx">ist</span> <span class="nx">c</span> <span class="nx">mal</span> <span class="nx">d</span><span class="p">.</span> <span class="nx">Wir</span> <span class="nx">staffeln</span> <span class="nx">die</span> <span class="nx">Bilder</span> <span class="nx">nach</span> <span class="nx">rechts</span><span class="p">.</span> <span class="mi">4</span><span class="err">×</span><span class="mi">25</span> <span class="nx">also</span> <span class="mi">100</span>  
    <span class="nx">f</span> <span class="nx">ist</span> <span class="nx">d</span> <span class="nx">mal</span> <span class="mi">2</span><span class="p">.</span> <span class="nx">Das</span> <span class="nx">ist</span> <span class="nx">Links</span> <span class="nx">und</span> <span class="nx">Rechts</span> <span class="nx">der</span> <span class="nx">Abstand</span> <span class="nx">zum</span> <span class="nx">Seitenrand</span><span class="p">.</span>
    <span class="nx">Jeweils</span> <span class="nx">eine</span> <span class="nx">Bildbreite</span><span class="p">.</span> <span class="nx">Also</span> <span class="mi">50</span> 
 
</code></pre>
</div>




<br /> <a href="images/matrix_think.png"><img src="images/matrix_think.png" width="100%" style="max-width:500px;" alt="" /></a><br />


<p>Also ist unsere Seitenbreite 150</p>

<p>Die Breite der Bilder mal der auf- oder abgerundeten Wurzel aus der Menge an Bildern plus eine Bildbreite links und eine rechts. (Lesen sie den vorherigen Satz nochmals und versuchen sie sich ein geistiges Bild von der Berechnung zu machen.)</p>

<p>oder  <br/>
g = [√a] × d + (d × 2)<br/>
oder</p>

<div class="highlight"><pre><code class="js">   <span class="kd">var</span> <span class="nx">pw</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">allImages</span><span class="p">.</span><span class="nx">length</span><span class="p">))</span> <span class="o">*</span> <span class="nx">w</span> <span class="o">+</span> <span class="p">(</span><span class="nx">w</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>  
</code></pre>
</div>


<p>Danach setzen wir die Höhe der Seite der Breite gleich.
Für den Fall das b (oder <code>Math.sqrt(allImages.length)</code>) eine Fliesskommazahl ist und wir eine nicht rechteckige Matrix erzeugen müssen, also alle Bilder platziert werden sollen, müssen wir die Höhe der Seite um eine Zeile für Bilder erweitern. Deshalb vergleichen wir in dem <code>if(statement)</code> ob die gerundete Quadratwurzel kleiner als die Quadratwurzel ist.</p>

<div class="highlight"><pre><code class="js">   <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">allImages</span><span class="p">.</span><span class="nx">length</span><span class="p">))</span> <span class="o">&lt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">allImages</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
</code></pre>
</div>


<p>oder<br/>
[√a] ≠ √a<br/>
oder<br/>
Wenn die Wurzel aus der Menge an Bilder nicht der gerundeten Wurzel aus der Menge an Bildern entspricht ist die Seitenhöhe die Seitenbreite plus eine Bildbreite. Wenn a also 17 ist wäre die Seite 150 breit und 175 hoch.</p>

<p>ich vermeide hier um es nicht noch weiter zu verkomplizieren jede Art von Maßeinheit. Das lassen wir InDesign selber regeln. In der Standard-Einstellung sind es Millimeter. Dies könnten wir definieren müssen wir aber nicht da InDesign immer eine Grundeinstellung hat.<br/>
Als nächstes folgen das erzeugen des Dokuments, das einstellen der Seite auf unsere errechneten Werte, das überführen der ersten Seite im Dokument in eine Variable und die Definition unseres Startpunktes.</p>

<div class="highlight"><pre><code class="js">   <span class="kd">var</span> <span class="nx">doc</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">documents</span><span class="p">.</span><span class="nx">add</span><span class="p">();</span>
        <span class="nx">doc</span><span class="p">.</span><span class="nx">documentPreferences</span><span class="p">.</span><span class="nx">pageWidth</span> <span class="o">=</span> <span class="nx">pw</span><span class="o">;</span>
        <span class="nx">doc</span><span class="p">.</span><span class="nx">documentPreferences</span><span class="p">.</span><span class="nx">pageHeight</span> <span class="o">=</span> <span class="nx">ph</span><span class="o">;</span>
    <span class="kd">var</span> <span class="nx">page</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">pages</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">w</span><span class="o">;</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">w</span><span class="o">;</span>
</code></pre>
</div>


<p>Diese Zeilen sind fast selbst erklärend. Wir fügen der Sammlung an Dokumenten ein neues hinzu. Dabei ist irrelevant ob bereits ein Dokument existiert oder nicht. Dann stellen wir die Weite und Höhe der Seite ein. Dann nehmen wir aus der Sammlung an Seiten in dem neuem Dokument die Erste. Der Aufruf <code>item(0)</code> ist ebenfalls ein ExtendScript Befehl der nur in InDesign funktioniert. wir könnten auch <code>var page = doc.pages[0]</code> schreiben. Hier funktioniert beides gleich. Das ist jedoch nicht immer der Fall. Es gibt zum Beispiel die Möglichkeit <code>doc.pages.middleItem()</code> oder <code>doc.pages.lastItem()</code> abzufragen. Bei einem normalen Array wie unserem <code>allImages</code> würde <code>lastItem()</code> nicht funktionieren. Danach erzeugen wir die Startpunkt unseres ersten Bildes. x und y sind jeweils eine Bildbreite vom Rand der Seite entfernt.
Es gibt noch die Möglichkeit die ersten drei Zeilen abzukürzen. Dies ist eine komprimiert Schreibweise die uns noch öfter begegnen wird.</p>

<div class="highlight"><pre><code class="js">   <span class="kd">var</span> <span class="nx">doc</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">documents</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span><span class="nx">documentPreferences</span><span class="o">:</span><span class="p">{</span><span class="nx">pageWidth</span><span class="o">:</span><span class="nx">pw</span><span class="o">,</span><span class="nx">pageHeight</span><span class="o">:</span><span class="nx">ph</span><span class="p">}});</span>
</code></pre>
</div>


<p>Aber zu dieser Schachtelung kommen wir noch. Wir sind bereits halb durch. Es folgt nochmals ein weiteres Konstrukt. die Schleife.</p>

<div class="highlight"><pre><code class="js">   <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">allImages</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="nx">page</span><span class="p">.</span><span class="nx">rectangles</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span><span class="nx">geometricBounds</span><span class="o">:</span><span class="p">[</span><span class="nx">y</span><span class="o">,</span> <span class="nx">x</span><span class="o">,</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">w</span><span class="o">,</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">w</span><span class="p">]});</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">place</span><span class="p">(</span><span class="nx">allImages</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">);</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">fit</span><span class="p">(</span><span class="nx">FitOptions</span><span class="p">.</span><span class="nx">FILL_PROPORTIONALLY</span><span class="p">);</span><span class="c">// fit it to the frame</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">fit</span><span class="p">(</span><span class="nx">FitOptions</span><span class="p">.</span><span class="nx">CENTER_CONTENT</span><span class="p">);</span><span class="c">// fit it to the frame</span>
    <span class="nx">x</span> <span class="o">+=</span><span class="nx">w</span><span class="o">;</span>
    <span class="p">}</span>
</code></pre>
</div>


<p>Mit dieser Schleife würden wir nur Bilder nach rechts weiter setzen. Den "Zeilenumbruch" fügen wir später ein. Erst einmal die Aussage der Schleife ähnelt der Kondition <code>for(statment){doSomething}</code> nur mit <code>for</code> anstatt <code>if</code>. Es könnte als an <em>solange</em> übersetzt werden. Solange du durch die Liste der Bilder zählen kannst. Die Aussage <code>for(var i = 0; i &lt; allImages.length; i++ )</code> ist  eine verkürzte Schreibweise für <code>for(var i = 0; i &lt; allImages.length; i = i + 1 )</code>. Es wäre  auch möglich <code>for(var i = 5; i &lt; 100; i= i +5)</code> zu schreiben. Das Bedeutet. Zähler i ist 5. Solange i kleiner als 100 ist, erhöhe i um 5. Im ersten durchlauf ist i 5 im zweiten 10 im dritten 15. Wir würden dann nur das 5te ,10te und 15te Bild erhalten anstatt alle.<br/>
Es folgt:</p>

<div class="highlight"><pre><code class="js">   <span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="nx">page</span><span class="p">.</span><span class="nx">rectangles</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span><span class="nx">geometricBounds</span><span class="o">:</span><span class="p">[</span><span class="nx">y</span><span class="o">,</span> <span class="nx">x</span><span class="o">,</span> <span class="nx">y</span> <span class="o">+</span> <span class="nx">w</span><span class="o">,</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">w</span><span class="p">]});</span>
</code></pre>
</div>


<p>Wir erzeugen auf der ersten Seite eine Rechteck, ähnlich wie unser Dokument und stellen die Aussenkanten ein. Die <code>geometricBounds</code>. Wir könnten auch folgendes schreiben.</p>

<div class="highlight"><pre><code class="js">   <span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="nx">page</span><span class="p">.</span><span class="nx">rectangles</span><span class="p">.</span><span class="nx">add</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">y1</span> <span class="o">=</span> <span class="nx">y</span><span class="o">;</span>
    <span class="kd">var</span> <span class="nx">x1</span> <span class="o">=</span> <span class="nx">x</span><span class="o">;</span>
    <span class="kd">var</span> <span class="nx">y2</span> <span class="o">=</span> <span class="nx">y1</span> <span class="o">+</span> <span class="nx">w</span><span class="o">;</span>
    <span class="kd">var</span> <span class="nx">x2</span> <span class="o">=</span> <span class="nx">x1</span> <span class="o">+</span> <span class="nx">w</span><span class="o">;</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">geometricBounds</span> <span class="o">=</span> <span class="p">[</span><span class="nx">y1</span><span class="o">,</span> <span class="nx">x1</span><span class="o">,</span> <span class="nx">y2</span><span class="o">,</span> <span class="nx">x2</span><span class="p">];</span>
</code></pre>
</div>


<p>Die Eigenschaft <code>geometricBounds</code> erwartet immer ein Array mit 4 Stellen. Diese geben die Linke obere Ecke und die Rechte untere Ecke an. Immer von der Oberen beziehungsweise linken Kante der Seite gemessen. Hierbei steht die y Koordinate vor der x Koordinate. Zu beachten ist auch, dass innerhalb von <code>add()</code> ein Doppelpunkt anstatt eines Gleichheitszeichens bei der Zuweisung des Wertes verwendet werden muss.<br/>
Es folgen drei einfache Befehle.</p>

<div class="highlight"><pre><code class="js">   <span class="nx">rect</span><span class="p">.</span><span class="nx">place</span><span class="p">(</span><span class="nx">allImages</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">);</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">fit</span><span class="p">(</span><span class="nx">FitOptions</span><span class="p">.</span><span class="nx">FILL_PROPORTIONALLY</span><span class="p">);</span><span class="c">// fit it to the frame</span>
    <span class="nx">rect</span><span class="p">.</span><span class="nx">fit</span><span class="p">(</span><span class="nx">FitOptions</span><span class="p">.</span><span class="nx">CENTER_CONTENT</span><span class="p">);</span><span class="c">// fit it to the frame</span>
    <span class="nx">x</span> <span class="o">+=</span><span class="nx">w</span><span class="o">;</span>
</code></pre>
</div>


<p>Das Bild mit dem Index i wird in dem Rechteck platziert, der Inhalt wird an die Grösse des Rechteckes angepasst, zentriert und wir erhöhen den x Wert um eine Bildbreite. Hier könnte auch <code>x = x + w</code> stehen. Es gibt weiter verkürzte Schreibweisen wie:</p>

<div class="highlight"><pre><code class="js">   <span class="nx">x</span><span class="o">-=</span><span class="mi">5</span><span class="o">;</span> <span class="c">//  equivalent to x = x - 5;</span>
    <span class="nx">x</span><span class="o">*=</span><span class="mi">5</span><span class="o">;</span> <span class="c">//  equivalent to x = x * 5;</span>
    <span class="nx">x</span><span class="o">/=</span><span class="mi">5</span><span class="o">;</span> <span class="c">//  equivalent to x = x / 5;</span>
</code></pre>
</div>


<p>Da wir in unserer Schleife sind passiert dies für die komplette Menge der Bilder unabhängig davon ob wir 5, 100 oder 10000 haben. Dies ist eine der großen Stärken von Skripten und Programmen. Die Iteration.<br/>
Damit wir jedoch nicht nur Bilder nach Rechts platzieren sondern umbrechen wenn x (oder x1) größer oder gleich der Breite der Seite minus der Bildbreite (der Rand) ist müssen wir eine weitere Kondition hinzufügen.</p>

<div class="highlight"><pre><code class="js">   <span class="k">if</span><span class="p">(</span><span class="nx">x</span> <span class="o">&gt;=</span> <span class="nx">pw</span> <span class="o">-</span> <span class="p">(</span><span class="nx">w</span><span class="p">)){</span>
    <span class="nx">x</span> <span class="o">=</span> <span class="nx">w</span><span class="o">;</span>
    <span class="nx">y</span><span class="o">+=</span> <span class="nx">w</span><span class="o">;</span>
    <span class="p">}</span>
</code></pre>
</div>


<p>Wenn diese Kondition nicht da wäre würde das Skript die Bilder wie in der folgenden Grafik platzieren. Achtung! Wenn zuviel Bilder über die Arbeitsfläche hinaus gehen kann das InDesign zum Absturz bringen und oder das Dokument unwiderruflich zerstören.</p>

<br /> <a href="images/matrx_without_breakline.png"><img src="images/matrx_without_breakline.png" width="100%" alt="" /></a><br />


<p>Die die es bis hier her geschafft haben sollten den obigen Code jetzt entschlüsseln können.<br/>
Wenn x grösser gleich 150 - 25, um auf unser Beispiel mit der 16 als Menge der Bilder zurückzukommen, setze x zurück auf 25 und addiere auf y 25 auf. die Zahlenreihe ist dann:</p>

<div class="highlight"><pre><code class="js">   
    <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nx">x</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="nx">y</span> <span class="o">=</span> <span class="mi">25</span>  
</code></pre>
</div>


<p>dann</p>

<div class="highlight"><pre><code class="js">   <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="nx">x</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="nx">y</span> <span class="o">=</span> <span class="mi">25</span>
</code></pre>
</div>


<p>Das passiert solange bis x 125 ist.<br/>
Dort setzt die Kondition <code>if(x &gt;= pw - (w))</code> an.<br/>
x wird in der Kondition zurück auf 25 gesetzt und y wird auf 50 gesetzt.
Dann ist</p>

<div class="highlight"><pre><code class="js">       <span class="nx">i</span> <span class="o">=</span> <span class="mi">4</span><span class="p">.</span>
    
</code></pre>
</div>


<p>Wir fangen bei 0 an zu Zählen im Array also ist <code>allImages[4]</code> das fünfte Bild.
und so weiter und so weiter.<br/>
Wir sind am Ende. Probieren sie den Code mit unterschiedliche vielen Jpg-Dateien aus. Verändern sie ihn bis er nicht mehr funktioniert und lesen sie die Fehlermeldungen. Dies ist ein weiterverbreitetes Problem. Computer und Programme würden viel an ihrer Mystik verlieren wenn einerseits die Nutzer die Meldungen lesen würde anstatt nur auf ok zu drücken und andererseits die Meldungen verständlich geschrieben wären.</p>

<br /> <a href="images/error.png"><img src="images/error.png" width="100%" alt="" /></a><br />  


<h2>Das Beispiel great power</h2>

<p>Ein weiters Skript, <em>greatPower.jsx</em>, welches aus nur einer Befehlszeile besteht und dennoch mächtig und auch ein wenig gefährlich ist.<br/>
Wenn bei der Entwicklung eines anderen Skripts immer wieder neue Dokumente erzeugt werden kann es schnell passieren, dass 10, 20, 50 Dokumente geöffnet sind. Die Oberfläche von InDesign bietet nicht die Möglichkeit alle geöffneten Dokumente zu schliessen ohne zu speichern. Das bedeutet das bei 50 Dokumenten 50 mal beim Schliessen entweder gespeichert oder das Dokument verworfen werden muss. Mit greatPower.jsx ist dies möglich. Um dies auszuprobieren erzeugen wir ein paar Dokumente mit dem Skript createDocuments.jsx. Dies is stark verkürzt in seiner Schreibweise und verwendet eine andere Art von Schleife. die <code>while</code> Schleife.</p>

<br /> <a href="images/algocreatedoc.png"><img src="images/algocreatedoc.png" width="100%" alt="" /></a><br />  




<div class="highlight"><pre><code class="js">   <span class="c">// createDocuments.jsx</span>
    <span class="kd">var</span> <span class="nx">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kd">var</span> <span class="nx">numberOfDocuments</span> <span class="o">=</span> <span class="mi">22</span><span class="o">;</span>
    <span class="k">while</span><span class="p">(</span><span class="nx">counter</span> <span class="o">&lt;=</span> <span class="nx">numberOfDocuments</span><span class="p">){</span>
    <span class="nx">app</span><span class="p">.</span><span class="nx">documents</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span>
        <span class="nx">documentPreferences</span><span class="o">:</span><span class="p">{</span>
            <span class="nx">pageWidth</span><span class="o">:</span><span class="mi">100</span><span class="o">,</span><span class="nx">pageHeight</span><span class="o">:</span><span class="mi">100</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="kd">var</span> <span class="nx">tf</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">activeDocument</span><span class="p">.</span><span class="nx">pages</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">textFrames</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span>
        <span class="nx">geometricBounds</span><span class="o">:</span><span class="p">[</span><span class="mi">10</span><span class="o">,</span><span class="mi">10</span><span class="o">,</span><span class="mi">90</span><span class="o">,</span><span class="mi">90</span><span class="p">]</span><span class="o">,</span>
        <span class="nx">contents</span><span class="o">:</span><span class="nb">String</span><span class="p">(</span><span class="nx">counter</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;Hello World&quot;</span>
        <span class="p">});</span>
    <span class="nx">tf</span><span class="p">.</span><span class="nx">characters</span><span class="p">.</span><span class="nx">everyItem</span><span class="p">().</span><span class="nx">properties</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">pointSize</span><span class="o">:</span><span class="mi">42</span>
        <span class="p">};</span>
    <span class="nx">counter</span><span class="o">++;</span>
    <span class="p">}</span>
</code></pre>
</div>


<p>Um diese 23 Dokumente wieder zu schliessen benutzen sie "greatPower.jsx"</p>

<br /> <a href="images/algogreatpower.png"><img src="images/algogreatpower.png" width="100%" alt="" /></a><br />  




<div class="highlight"><pre><code class="js">   <span class="c">// Like Uncle Ben saz: &quot;With great power comes great responsability!&quot;</span>
    <span class="nx">app</span><span class="p">.</span><span class="nx">documents</span><span class="p">.</span><span class="nx">everyItem</span><span class="p">().</span><span class="nx">close</span><span class="p">(</span><span class="nx">SaveOptions</span><span class="p">.</span><span class="nx">NO</span><span class="p">);</span>
</code></pre>
</div>


<p>Wenn nun dem ein oder anderem der Gedanke kommt: "Das ist doch alles viel zu kompliziert!" Warum dies mehr Unwille den Unvermögen ist werde ich versuchen im nächsten Teil zu untersuchen.</p>

<h2>Die Angst</h2>

<p>[NOCH NICHT GESCHRIEBEN]</p>

<h2>Ein Werkzeug</h2>

<p>Wo bleibt die extra Zeit für Gestaltung die versprochen wurde? Wie bereits erwähnt braucht das lernen einer Sprache etwas Zeit. Die Grammatik und Rechtschreibung können aus einem Buch gelernt werden, die Nuancen und Umgangssprache kann jedoch nur durch das Sprechen geschult werden.<br/>
Zum Glück sind wir hier nicht alleine. Es gibt bereits viele Werkzeuge die frei zur Verfügung stehen und zur Optimierung unserer Arbeitsprozesse genutzt werden können. In diesem Sinne habe ich das Skript AEMap.jsx für Adobe After Effects geschrieben.</p>

<br /> <a href="images/aemapuiv02a.png"><img src="images/aemapuiv02a.png" width="100%" alt="" /></a><br />  


<p>Viele Motion Designer kommen irgendwann einmal an den Punkt an dem sie eine Weltkarte oder die Aussenkontur eines Landes benötigen. Bisher war es so das immer wieder eine Websuche begann nach benutzbaren Kartenmaterial. Hierbei entstehen einige Problem. Die Rechte an Kartenmaterial das "einfach so" aus dem Netz gezogen wurde sind oft ungeklärt. Manchmal sind es Vektor-Dateien wenn man Pech hat sind es Pixelbilder. Diese Quelldatei liegt dann innerhalb eines Projektes und wird mit diesem archiviert. Wenn sie wieder benötigt wird beginnt die Suche aufs neue. Was bei vielen absolvierten Projekten schnell zeitraubend werden kann. After Effects Projekte können schnell aus hunderten Quelldateien bestehen und sind gerne nach persönlichem Gusto sortiert. Was wenn dann nicht nur eine Weltkarte sondern zum Beispiel die Kontur von Ost-Timor und Papua Neu Guinea benötigt wird?</p>

<br /> <a href="images/ostimorpaua_01.jpg"><img src="images/ostimorpaua_01.jpg" width="100%" alt="" /></a><br />  


<p>Selbst wenn eine vernünftige Vektor-Form einer Karte existiert und griffbereit ist wie könne die beiden Länder gefunden werden? Was ist wenn eine Grenzänderung stattfindet? Und und und. Um diesen Problemen zu entgehen kann AEMap.jsx eine Weltkarte in Rektangularprojektion erzeugen. Dabei entsteht eine After Effects Komposition in einer gewählten Skalierung (immer 2:1) in der 178 Prä-Kompositionen enthalten sind die 286 einzelne Polygon-Gruppen beinhalten.</p>

<br /> <a href="images/aemapfullcomp.png"><img src="images/aemapfullcomp.png" width="100%" alt="" /></a><br />  


<p>Der Nutzer kann zwischen verschiedenen Einstellungen wählen wie zum Beispiel die Karte mit Kontur zu zeichnen oder ohne oder ob alle Polygone auf eine Ebene gezeichnet werden sollen oder ob in die oben genannten Kompositionen gesplittet werden soll. Ebenfalls können 3D Einstellungen definiert werden und ähnliche mehr. Die Daten bestehen auf einem GeoJson Datensatz der zum freien Gebrauch ins Netz gestellt wurde. Der gesamten Funktionsumfang ist auf <a href="http://fabiantheblind.github.com/AEMap/">dieser Webseite</a> dokumentiert. Dieses Skript spart nicht nur mir Zeit sondern auch anderen. Die Resonanz in der After Effects Community" ist gross. Daher hat das Skript seit seiner Veröffentlichung auf <a href="http://aescripts.com/aemap/">AEScripts.com</a> am 10 April 2012 bereits über 400 Downloads gehabt (heute 24 April 2012). Das Tutorial und das Demo wurden bereits über 4000 mal auf Youtube geladen. Aber genug der Selbstbeweihräucherung. Der Vorteil an solchen und ähnlichen Werkzeugen die zum Beispiel auf AEScripts.com bereit gestellt werden ist, dass diese meist aus dem Zwang heraus entstanden sind einen Arbeitsablauf zu automatisieren um Zeit zu sparen.</p>

<h2>Fazit</h2>

<p>[NOCH NICHT GESCHRIEBEN]</p>

<hr />

<h2>Die kleine Terminologie</h2>

<h3>Was ist Code?</h3>

<p>Als Code bezeichnen wir in der Regeln Informationen die verschlüsselt (encoding) werden um dann an einer weiteren Stelle wieder entschlüsselt zu werden (decoding). Zum Beispiel stellt Morse-Code Buchstaben dar indem ein einziges unmoduliertes Signal, zum Beispiel ein Ton, in kurze und lange Sequenzen unterteilt wird. Der Rezipient kann dann, wenn er des Systems mächtig ist, diese Informationen entschlüsseln und zu der originalen Nachricht wieder zusammensetzen. Ein weiters Bespiel ist der Abakus. Dieser erlaubt es wenn der Benutzer des Systems mächtig ist Rechenoperationen auszuführen. Und als drittes die Knotenschrift der Inkas die wie der Name bereits besagt aus einem System von Knoten auf einem Satz Schnüren bestand. Heutzutage findet das Wort "Code" im Computerbereich oft Verwendung als Kurzform des Ausdrucks "Source-Code" also Quelltext eines Programms.</p>

<h3>Was ist ein Programm?</h3>

<p>Das Bild das viele im Kopf haben wenn sie das Wort Programm hören ist stark durch Film beeinflusst. Wir sehen junge, meist übergewichtig und verpickelte Menschen vor uns die in abgedunkelten Räumen zwischen Monitoren, Kabeln und Pizzapackungen auf ewige grün leuchtende Zahlenkolonnen blicken die für uns keinerlei Sinn ergeben. Diese oder ähnliche Bilder sind inspiriert aus einer Zeit in der Computer nur einfarbige Pixel hatten und Grafische Benutzeroberflächen wie Windows noch aus der Kommandozeile gestartet wurde. Als Hommage an diese Vorstellung hat "Duiker101" das Programm <a href="http://hackertyper.net/">HackerTyper</a> entworfen welches mit bereits vorgegebenem Text allein über Tastendruck den Bildschirm mit kompliziertem Quelltext füllt. Dabei ist es irrelevant welche Tasten der Benutzer drückt.
Verwerfen sie diese Vorstellung (Es ist nicht so das es dies nicht gibt dennoch entspricht es nicht der Regel). Ein Programm ist lt. <a href="http://www.duden.de/rechtschreibung/Programm">Duden</a>: "die nach einem Plan genau festgelegten Einzelheiten eines Vorhabens". Unter dieser Betrachtungsweise ist jede Bauanleitung zu Möbelstücken, eine Beschreibung des Weges von hier zum Bahnhof oder das Rezept für Sahnetörtchen ein Programm. Bloß das in letzterem Fall nicht ein Computer die Anweisungen ausführt sondern ein Mensch. Die Sprache in der dieses Programm geschrieben ist, ist Deutsch. Der grosse Unterschied zu einem Computersprache/-programm liegt hier ein der Möglichkeit der Interpretation. Die Ausführende "Maschine" (in diesem Fall der Mensch) kann solche Angaben wie "eine Priese Salz" oder "eine Messerspitze Meerrettich" verarbeiten. Ein Computer ist hierzu (noch) nicht fähig. Er bräuchte eine eindeutigere Angabe wie 50 Gramm. Das Programm sollte an dieser Stelle noch von dem Begriff des Algorithmus abgetrennt werden.</p>

<h3>Was ist ein Algorithmus?</h3>

<p>Auch wenn sich diese beiden Begriffe in ihrer Bedeutung teilweise überschneiden sollten sie auf folgende weise unterschieden werden. Der Algorithmus für Milch holen wäre in Pseudocode:</p>

<pre><code>wenn (Aussage (kein Milch ist im Kühlschrank) wahr ist): hole neue Milch! wenn nicht: tue nichts!  
</code></pre>

<p>Das Programm für Milch holen würde voraussetzen das alle Schritte und Notwendigkeiten bis zum Übergang der Milch in das Eigentum der Holenden bekannt und definiert sind. Also so etwas wie:</p>

<pre><code>Person fabian ist gleich neu Person;
Kühlschrank Schrank ist gleich neuer Kühlschrank;
Kühlschrank Menge Milch ist gleich 1;
jeden morgen fabian trinke Milch aus Kühlschrank;
Menge Milch reduziere um 0.2l;
jeden morgen fabian beobachte Menge Milch;
wenn Milch kleiner gleich 0.1 ist fabian hohle Milch im Supermarkt;
</code></pre>

<p>Und so weiter und so ähnlich. Diese Funktionsanweisungen könnten noch detaillierter ausgearbeitet werden. Hierbei sei zu beachten das solche Objekte wie Kühlschrank und Person bereits implementiert also bekannt sind. Das Programm im Vergleich zum Algorithmus muss alle eingesetzten Mittel kennen und oder selber beschreiben.</p>

<h3>Was ist die Syntax?</h3>

<p>Die Syntax ist die Form in der die Programmiersprache ausgestaltet ist. Die Syntax einer Programmiersprache besteht aus reservierten Worten wie zum Beispiel in Java <code>new, while, null , true,</code> Operatoren wie  <code>+,-,*,.</code> und Kontrollstrukturen wie <code>if(){}else{}</code> oder "<code>for(int i = 0; i &lt; x;i++)</code><br/>
Lesen sie diese "Sätze" kurz. Wie würden sie es sprechen?</p>

<p>Ausgesprochen wäre dies: <code>For int i gleich 0, i kleiner x, i plus plus</code></p>

<p>Es gibt in JavaScript eine Hand voll <a href="https://developer.mozilla.org/en/JavaScript/Reference/Reserved_Words">reservierter Worte (Mozilla Developer Network)</a> die beim schreiben nicht verwendet werden dürfen.</p>

<div class="highlight"><pre><code class="js"><span class="k">break</span><span class="o">,</span> <span class="nx">case</span><span class="o">,</span> <span class="k">catch</span><span class="o">,</span> <span class="k">continue</span><span class="o">,</span> <span class="nx">debugger</span><span class="o">,</span> <span class="nx">default</span><span class="o">,</span> <span class="nx">delete</span><span class="o">,</span> <span class="k">do</span><span class="o">,</span> <span class="k">else</span><span class="o">,</span> <span class="nx">finally</span><span class="o">,</span> 
<span class="k">for</span><span class="o">,</span> <span class="kd">function</span><span class="o">,</span> <span class="k">if</span><span class="o">,</span> <span class="k">in</span><span class="o">,</span> <span class="k">instanceof</span><span class="o">,</span> <span class="k">new</span><span class="o">,</span> <span class="k">return</span><span class="o">,</span> <span class="nx">switch</span><span class="o">,</span> <span class="k">this</span><span class="o">,</span> <span class="k">throw</span><span class="o">,</span> <span class="k">try</span><span class="o">,</span> <span class="k">typeof</span><span class="o">,</span> 
<span class="kd">var</span><span class="o">,</span> <span class="nx">void</span><span class="o">,</span> <span class="k">while</span><span class="o">,</span> <span class="kd">with</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="kc">true</span> 
</code></pre>
</div>


<p>Noch einmal. Diese Worte dürfen nur für bestimmte Aufgaben verwendet werden! Wenn also ein Programmierer seine Variable <code>null</code> nennet, wird das Programm beim ausführen eine Fehler auswerfen. Die obig genannten Strukturen, Operatoren und reservierten Worte müssen erlernt werden. Eine vollständige Beschreibung aller würde jedoch den Rahmen dieser Arbeit sprengen.<br/>
Weiterhin ist beim schreiben von Programmen auch auf die Groß- und Kleinschreibung zu achten. Eine Variable die mit dem Namen <code>myValue</code> initiiert wird muss auch mit diesem Namen aufgerufen werden. Bei einer falschen Schreibweise <code>MyValue</code> oder <code>myvalue</code> würde das Programm warnen, dass die aufgerufene Variable nicht existiert.</p>

<div class="highlight"><pre><code class="js">   <span class="kd">var</span> <span class="nx">myValue</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span> <span class="c">// define a variable</span>
    <span class="nx">myvalue</span><span class="o">++;</span> <span class="c">//edit it but written wrong</span>
</code></pre>
</div>




<br /> <a href="images/error_myvalue.png"> <img src="images/error_myvalue.png" width="100%" style="max-width:800px;" alt="" /></a>


<p>Es gibt Sprachen die versuchen ihre Syntax so weit wie möglich an unseren Sprachen zu orientieren, zum Beispiel Applescript:</p>

<div class="highlight"><pre><code class="applescript">  <span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;Safari&quot;</span> <span class="k">to</span> <span class="nb">activate</span>
</code></pre>
</div>


<p>und wieder andere wie die esoterische Programmiersprache* "Brainfuck" die mit ihren acht Zeichen</p>

<div class="highlight"><pre><code class="bf"><span class="c">   </span><span class="nb">+</span><span class="c"> </span><span class="nb">-</span><span class="c"> </span><span class="nv">&lt;</span><span class="c"> </span><span class="nv">&gt;</span><span class="c"> </span><span class="k">[</span><span class="c"> </span><span class="k">]</span><span class="c"> </span><span class="nt">,</span><span class="c"> </span><span class="nt">.</span><span class="c"></span>
</code></pre>
</div>


<p>voll funktionsfähig, aber nicht für das schreiben von Programmen gedacht ist sondern eher ein Gedankenmodell darstellt.
Das Brainfuck Hello World (<a href="http://en.wikipedia.org/wiki/Brainfuck">aus wiki</a>):</p>

<div class="highlight"><pre><code class="bf"><span class="c">   </span><span class="nb">+++++</span><span class="c"> </span><span class="nb">+++++</span><span class="c">             initialize counter (cell #0) to 10</span>
<span class="c">    </span><span class="k">[</span><span class="c">                       use loop to set the next four cells to 70/100/30/10</span>
<span class="c">        </span><span class="nv">&gt;</span><span class="c"> </span><span class="nb">+++++</span><span class="c"> </span><span class="nb">++</span><span class="c">              add  7 to cell #1</span>
<span class="c">        </span><span class="nv">&gt;</span><span class="c"> </span><span class="nb">+++++</span><span class="c"> </span><span class="nb">+++++</span><span class="c">           add 10 to cell #2 </span>
<span class="c">        </span><span class="nv">&gt;</span><span class="c"> </span><span class="nb">+++</span><span class="c">                   add  3 to cell #3</span>
<span class="c">        </span><span class="nv">&gt;</span><span class="c"> </span><span class="nb">+</span><span class="c">                     add  1 to cell #4</span>
<span class="c">        </span><span class="nv">&lt;&lt;&lt;&lt;</span><span class="c"> </span><span class="nb">-</span><span class="c">                  decrement counter (cell #0)</span>
<span class="c">    </span><span class="k">]</span><span class="c">                   </span>
<span class="c">    </span><span class="nv">&gt;</span><span class="c"> </span><span class="nb">++</span><span class="c"> </span><span class="nt">.</span><span class="c">                  print &#39;H&#39;</span>
<span class="c">    </span><span class="nv">&gt;</span><span class="c"> </span><span class="nb">+</span><span class="c"> </span><span class="nt">.</span><span class="c">                   print &#39;e&#39;</span>
<span class="c">    </span><span class="nb">+++++</span><span class="c"> </span><span class="nb">++</span><span class="c"> </span><span class="nt">.</span><span class="c">              print &#39;l&#39;</span>
<span class="c">    </span><span class="nt">.</span><span class="c">                       print &#39;l&#39;</span>
<span class="c">    </span><span class="nb">+++</span><span class="c"> </span><span class="nt">.</span><span class="c">                   print &#39;o&#39;</span>
<span class="c">    </span><span class="nv">&gt;</span><span class="c"> </span><span class="nb">++</span><span class="c"> </span><span class="nt">.</span><span class="c">                  print &#39; &#39;</span>
<span class="c">    </span><span class="nv">&lt;&lt;</span><span class="c"> </span><span class="nb">+++++</span><span class="c"> </span><span class="nb">+++++</span><span class="c"> </span><span class="nb">+++++</span><span class="c"> </span><span class="nt">.</span><span class="c">  print &#39;W&#39;</span>
<span class="c">    </span><span class="nv">&gt;</span><span class="c"> </span><span class="nt">.</span><span class="c">                     print &#39;o&#39;</span>
<span class="c">    </span><span class="nb">+++</span><span class="c"> </span><span class="nt">.</span><span class="c">                   print &#39;r&#39;</span>
<span class="c">    </span><span class="nb">-----</span><span class="c"> </span><span class="nb">-</span><span class="c"> </span><span class="nt">.</span><span class="c">               print &#39;l&#39;</span>
<span class="c">    </span><span class="nb">-----</span><span class="c"> </span><span class="nb">---</span><span class="c"> </span><span class="nt">.</span><span class="c">             print &#39;d&#39;</span>
<span class="c">    </span><span class="nv">&gt;</span><span class="c"> </span><span class="nb">+</span><span class="c"> </span><span class="nt">.</span><span class="c">                   print &#39;!&#39;</span>
<span class="c">    </span><span class="nv">&gt;</span><span class="c"> </span><span class="nt">.</span><span class="c">                     print &#39;\n&#39; </span>
<span class="c"> </span>
</code></pre>
</div>


<p>Wie bereits oben in der Beschreibung des Milchalgorithmus zu sehen ist verwendet selbst Pseudocode ein nicht genau definierte Syntax lehnt sich jedoch mit Konstruktionen wie "ist gleich" an die Mathematik und Programmierung an. Andere Sprachen mit denen wir uns noch später Auseinandersetzen wie C++, Processing oder JavaScript sind zwischen diesen Extrema angesiedelt und vereinen in einer für das geübte Auge lesbaren und dennoch kompakte Art die Befehlsaufrufe.</p>

<h3>Was ist Pseudocode?</h3>

<p>Im Verlaufe dieser Arbeit werde ich immer wieder auf die Darstellung von Algorithmen in "Pseudocode" zurückgreifen. Pseudocode besteht nicht aus einer bereits definierten Syntax und kann auch nicht von einem Compiler übersetzt werden sondern dient nur zur Darstellung eines logischen Ablaufs. Wie bereits in dem Milchalgorithmus zu sehen war versucht Pseudocode einen Programmablauf in menschenlesbarer Form darzustellen.</p>

<h3>Was ist ein Compiler?</h3>

<p>Der Vollständigkeit halber soll dieser hier erklärt werden auch wenn er uns kaum mehr im weiteren Verlauf der Arbeit begegnen wird. Der Compiler ist ebenfalls ein Programm das aus menschenlesbaren Hochsprachen wie zum Beispiel C++ maschinenlesbaren Quelltext erzeugt (Assemblercode). Diesen Prozess bezeichnet man auch als Kompilierung.</p>

<h3>Was ist eine IDE (Integrated Development Envoirement)?</h3>

<p>Um Quelltext zu schreiben bedarf es nicht viel. Ein einfacher Texteditor reicht aus um komplette Programme zu schreiben. Im Laufe der Zeit wurde jedoch viel Software programmiert um das schreiben von Quelltext zu erleichtern. Dies geht los bei einfachem Syntax-Highlighting bis hinzu kompletten Entwicklungsumgebungen die noch vor dem Kompilieren beziehungsweise während des Schreibens die Syntax auf ihre Validität prüfen und gegebenenfalls Vorschläge machen was gemeint sein könnte oder bei nicht verwendeten Programmteilen warnen das diese derzeit unnütz sind. In unserem Fall-Beispiel werden wir noch mit diesen Programmen zu tuen kriegen. Es sei jedoch bereits gesagt das wir die einfachste Möglichkeit nutzen werden die sich uns bietet und die auf beiden Plattformen (Windows und Mac OS X) zur Verfügung steht. Das ExtendScript Toolkit (Mehr hierzu ist im nächsten Abschnitt zu finden).</p>

<h3>Was ist Hello World?</h3>

<p>Das "Hello World" Programm hat sich als Standard Beispiel etabliert um die Syntax einer Sprache zu erklären. Exerzieren wir das einmal kurz durch. Um für Adobe InDesign, After Effects, Illustrator, Photoshop, Photoshop Elements, Photoshop Elements Organizer, Bridge, Audition, Media Encoder und Premiere Pro Skripte zu schreiben liefert Adobe eine eigene IDE, eine Integrierte Entwicklung Umgebung, mit.</p>

<br /> <a href="images/estk.png"> <img src="images/estk.png" width="100%" alt="" /></a>


<p>Das ExtendScript Toolkit. Dies ist nicht der schönste Editor. Er hat jedoch einige Vorteile die die Entwicklung von Skripten sehr einfach macht. Die wichtigste Eigenschaft ist dabei folgende. Es kann ein Skript ohne es zu speichern ausführen. Das Toolkit wird bei der Installation von Adobe Produkten direkt mit geliefert. Suchen sie es in ihren Dienstprogrammen dort sollten sie fündig werden. Wenn nicht gehen sie zu dieser Webseite <a href="http://www.adobe.com/devnet/scripting.html">http://www.adobe.com/devnet/scripting.html</a>, laden und installieren sie es.<br/>
Wenn es dann installiert ist geben sie folgende Text ein:</p>

<div class="highlight"><pre><code class="js">   <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">);</span>
</code></pre>
</div>


<p>und drücken sie auf den "Play/Run" Knopf oben rechts oder drücken sie CMD-r oder CTRL-r, abhängig von ihrer Platform.</p>

<br /> <a href="images/hello_world.png"> <img src="images/hello_world.png" width="100%" alt="" /></a>


<p>Herzlichen Glückwunsch. Ihr erstes JavaScript.<br/>
Um dieses Skript in InDesign oder Photoshop auszuführen muss die Ziel Applikation aus dem PullDown Menü auf der oberen Leiste gewählt werden. Beim öffnen ist es auf ExtendScript Toolkit gestellt. Wählen sie dort InDesign aus. Das Toolkit wird sofort fragen ob InDesign auch gestartet werden soll. Bestätigen sie das und führen sie das Skript noch einmal aus. Sie werden sehen, dass der Computer zu InDesign überwechselt und den gleichen Hinweis gibt.<br/>
Probieren sie weiter Skripte und Kalkulationen aus. Zum Beispiel</p>

<div class="highlight"><pre><code class="js">   <span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="s2">&quot;Hello&quot;</span><span class="o">;</span>
    <span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="s2">&quot;World&quot;</span><span class="o">;</span>
    <span class="kd">var</span> <span class="nx">calc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span><span class="o">/</span><span class="mi">23</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">h</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">w</span> <span class="o">+</span><span class="s2">&quot;! Your result is: &quot;</span><span class="o">+</span> <span class="nx">calc</span> <span class="p">);</span> 
 
</code></pre>
</div>


<h3>Was ist Syntax-Highlighting?</h3>

<br /> <a href="images/syntax_highlite.png"><img src="images/syntax_highlite.png" width="100%" alt="" /></a>


<p>Syntax-Highlighting ist eine Hilfestellung für Programmierer um ihren Quelltext übersichtlicher zu gestalten. Hierbei werden bestimmte Teile wie Operatoren,Kommentare, Funktionsdeklarationen oder Reservierte Worte farblich hervorgehoben beziehungsweise zurückgenommen um das Lesen zu erleichtern.</p>

<h3>Was ist eine API (Application Programming Interface)?</h3>

<p>Dies ist die Schnittstelle die ein Programm bietet um auf sein Funktionen zugreifen zu können. Dies wird beim Schreiben von Programmen wie InDesign von den Programmierern definiert. Diese Schnittstelle ist wie ein Baum mit Querverweisen aufgebaut. Um in InDesign einem bestehendem Dokument auf der ersten Seite eine Textbox hinzuzufügen muss durch diesen Baum manövriert werden.</p>

<pre><code>app.activeDocument.pages.item(0).textFrames.add();
</code></pre>

<p>Diese Zeile erzeugt in der linken oberen Ecken eine Textkiste.<br/>
All diese Befehle und Eigenschaften müssen nicht auswendig gelernt werden sondern können nachgeschlagen werden. Im ExtendScript Toolkit kann unter Hilfe / ObjektModell Viewer ein Hilfsprogramm aufgerufen werden das alle Befehle mit einer kurzen Erklärung enthält. Oder es kann auf der Seite von jongware eine .chm Datei heruntergeladen werden die die gleichen Informationen enthält und mit einem .chm Viewer durchsucht werden kann. <a href="http://www.jongware.com/idjshelp.html">http://www.jongware.com/idjshelp.html</a></p>

<h3>Was ist Objektorientierung?</h3>

<p>Als Objektorientierung (ach als OO abgekürzt) versteht man ein bestimmte Art wie Programme aufgebaut sind. Ein Objekt ist ein gekapselter Teil des Programmcodes der Schnittstellen und Methoden bietet und seine Eigenschaften an weiter Objekte vererben kann. Um dies besser zu verstehen möchte ein hervorragendes Beispiel aus "Processing: A Programming Handbook for Visual Designers and Artists" von Casey Reas and Ben Fry bemühen.</p>

<h4>Klammer auf!</h4>

<pre><code>{  
</code></pre>

<p>Der Proto-Apfel (Der Proto-Apfel existiert eigentlich nicht. Unsere Sprache lässt solche Ungenauigkeiten zu. Es gibt einen Apfel und einen Anderen. Aber nicht "DEN" Apfel. ) hat bestimmte Eigenschaften wie Gewicht und Farbe. Hinzu kommen bestimmte Methoden wie Fallen, Wachsen und Verrotten die durch die Eigenschaften beeinflusste werden können.</p>

<br /> <a href="images/object_orientation_classes-1.png"><img src="images/object_orientation_classes-1.png" width="100%" alt="" /></a>


<p> Wenn nun ein Baum wächst und Äpfel produziert erzeugt er nach dem Bauplan des Proto-Apfels neue Äpfel und jedem werden bestimmte Werte übergeben.</p>

<br /> <a href="images/object_orientation_classes-2.png"><img src="images/object_orientation_classes-2.png" width="100%" alt="" /></a>


<p>Der Baum erzeugt den Apfel und ruft kontinuierlich die Methode Wachsen auf. Hierbei wird der Wert des Gewichtes inkrementiert. Sind die Früchte dann reif wird abhängig vom Gewicht des einzelnen Apfels die Methode Fallen ausgelöst. Wenn der Apfel dann auf dem Boden liegt und die Methode Fallen beendet ist beginnt die Methode Verrotten ihre Arbeit. Die Farbe des Apfels verändert sich und das Gewicht wird wieder verringert.
Das bedeutet der Proto-Apfel selber wird nicht angerührt sondern Instanzen von diesem. Um dies noch auf die Spitze zu treiben haben wir nicht nur eine Art Apfel sondern verschieden Sorten. Also ist die Klasse Granny Smith und ein "Kind"-Klasse der Basisklasse Apfel. Granny Smith erbt alle Eigenschaften der Klasse Apfel ohne das sie neu implementiert werden müssen und bekommt noch eine weitere Eigenschaft: den Namen.</p>

<pre><code>} // Klammer zu.  
</code></pre>

<p>Dieses Konstruktionsweise spiegelt sich in nicht nur in der Programmierung wieder. Die Benutzung einiger Komponenten in unseren Werkzeugen ist genau nach diesem Prinzip organisiert.</p>

<h4>Eine weiter Klammer auf</h4>

<pre><code>{
</code></pre>

<p>In InDesign hat der Benutzer die Möglichkeit Absatz- und Zeichenformate anzulegen ohne die das setzen eines Buches eine wirklich Zeitraubende Angelegenheit wäre. Eine einfache Gruppe von Absatzformaten kann wie folgt aufgebaut sein.<br/>
- [Einfacher Absatz]<br/>
- TextKörper<br/>
- Überschrift 1<br/>
- Überschrift 2<br/>
- Überschrift 3<br/>
- Bild Unterschrift<br/>
- Pagina<br/>
In dem Format "[Einfacher Absatz]" wird eine Schriftart und eine Schriftgrösse definiert. Dieses Format ist das Proto-Format von dem sich alle weiteren Formate ableiten. Sie erben also alle die Eigenschaften Schrift (appliedFont) und die Schriftgrösse (pointSize). Das Format "Überschrift 1" (Ü1) bekommt dann eine eigene Schriftgrösse und einen fetten Schnitt der Schriftart. Im dem Format "Überschrift 2" (Ü2) wird dann festgelegt das nicht mehr das "[Einfacher Absatz]" Format als Basis Klasse benutzt wird sondern Ü1. Damit erbt Ü2 alle Eigenschaften von Ü1. In Ü2 wird dann nur noch eine neue Schriftgrösse festgelegt. Das gleiche kann dann mit "Überschrift 3" (Ü3) passieren. Ü3 basiert auf Ü2 und bekommt ebenfalls eine eigene Schriftgrösse. Jetzt basiert Ü3 auf Ü2, das auf Ü1 und das auf "[Einfacher Absatz]". Ähnlich verfahren wir mit den weiteren Formaten. "Textkörper" basiert auf "[Einfacher Absatz]", "Bildunterschrift" auf "Textkörper" nur kleiner und "Pagina" auf "Bildunterschrift" aber mit 70% Deckkraft. Wenn der Gestalter nun entscheidet dass eine andere Schriftart von Nöten ist, ändert er sie nur in "[Einfacher Absatz]" und alle Kinder werden entsprechend angepasst. Dies ist ebenfalls Objektorientiert.</p>

<br /> <a href="images/id_formate.png"><img src="images/id_formate.png" width="100%" alt="" /></a>


<pre><code>} // Klammer zu
</code></pre>

<h3>Was sind Funktionen/Methoden?</h3>

<p>Eine Funktion oder eine Methode sind gekapselte Programmteile and die Parameter übergeben werden können und die an den gegebenen Parametern eine Kalkulation durchführen. Sie können dann Werte zurückgeben. Dies ist nützlich wenn bestimmte Tätigkeiten an unterschiedlichen Positionen eins Programms oder Skripts mehrmals aufgerufen werden müssen.</p>

<h3>Was ist ein Bug?</h3>

<p>Ein Bug ist ein Fehler der das Programm von seiner einwandfreien Ausführung abhält. Dies kann nur ein Rechenfehler sein oder ein Fehler der das gesamte Programm zum Absturz bringt.</p>

<h3>Was ist Debugging?</h3>

<p>Dies ist der Prozess des Finden und korrigieren von Fehlern.</p>

<h3>Was ist ein Workaround?</h3>

<p>Ein Workaround ist eine kreative Lösung um ein Problem zu umgehen. Wenn zum Beispiel eine API ein bestimmte Funktion nicht anbietet muss ein Weg um dieses Problem drumherum gefunden werden.</p>

<h3>Welche Konventionen gibt es?</h3>

<p>Neben den Bestimmungen der Syntax gibt es verschiedene Konventionen die das lesen von Skripten einfacher machen sollen. Zum Beispiel ist es gang und gebe dass die Funktionsweise am Beginn eines Skripts in einem Kommentar erklärt wird. Oder die Verwendung der Variable i (für Iterator) als Zähler in Schleifen.</p>

<h3>Herkunft von JavaScript</h3>

<p>JavaScript orientiert sich in seiner Syntax an C und C++.
Zur Veranschaulichung was dies bedeutet hier ein Programm das folgende Aufgaben erledigt.</p>

<ul>
<li>Zwei Zahlen  in Variablen definieren</li>
<li>Ein Objekt mit folgenden 3 Eigenschaften erzeugen</li>
<li>Einem Namen</li>
<li>Einer Funktion die 2 Zahlen mit einander vergleicht und feststellt welche die grössere von beiden ist.</li>
<li>Eine Ergebnis zurück geben</li>
<li>Einen Satz aus allen Variablen zusammenstellen</li>
<li>Diesen Satz darstellen</li>
</ul>


<p>Dieses Programm liegt hier in verschiedenen Sprachen vor.<br/>
Ich werde hier kurz auf kleine Unterschiede eingehen und versuchen an diesen 3 Beispielen zu erläutern warum JavaScript eine einfach und mächtige Sprache ist. An dieser Stelle ist es nicht zwingend den Programmcode komplett zu verstehen. Beachten sie nur die syntaktischen Unterschiede. Vergleichen sie die Funktion oder Methode <code>int Object::compare(int a, int b)</code> in C++ mit <code>int compare(int a, int b)</code> in C und betrachten sie danach die Funktion / Objekt <code>compare : function(a,b){if(a&gt;b){return a;}else{return b;}</code> in JavaScript. Es gibt kleine Unterschiede aber die gemeinsame Herkunft ist unübersehbar. Eine tiefere Erklärung des Quelltextes findet sich in den Kommentaren der einzelnen Programme und des Skriptes.</p>

<h4>Assembler (anObject.s)</h4>

<p>Dies ist die Variante die die Maschine versteht. Es wurde jedoch nicht von mir geschrieben sondern ist das Ergebnis des Kompilierungs-Prozesses des C++ Programms. Näher wäre nur noch Nullen und Einsen zu schrieben. Ich drucke dies hier der Vollständigkeit halber ab. Ja - es gibt auch diesen Aspekt der Programmierung der genau dem entspricht was Menschen davon abhält sich mit ihr auseinander zu setzen. Um dort an zu gelangen ist es ein weiter Weg den wenige gehen und auch wir nicht beschreiten werden in dieser Arbeit. Aus Platzgründen werde ich hier nur die ersten 29 Zeilen zeigen. Das gesamte Programm in Assembler Code ist über 700 Zeilen lang und ist im Download Packet enthalten.</p>

<div class="highlight"><pre><code class="cpp">      <span class="p">.</span><span class="n">section</span>  <span class="n">__TEXT</span><span class="p">,</span><span class="n">__text</span><span class="p">,</span><span class="n">regular</span><span class="p">,</span><span class="n">pure_instructions</span>
        <span class="p">.</span><span class="n">globl</span>    <span class="n">__ZN6Object7compareEii</span>
        <span class="p">.</span><span class="n">align</span>    <span class="mi">1</span><span class="p">,</span> <span class="mh">0x90</span>
    <span class="nl">__ZN6Object7compareEii:</span>
    <span class="nl">Leh_func_begin1:</span>
        <span class="n">pushq</span>    <span class="o">%</span><span class="n">rbp</span>
    <span class="nl">Ltmp0:</span>
        <span class="n">movq</span> <span class="o">%</span><span class="n">rsp</span><span class="p">,</span> <span class="o">%</span><span class="n">rbp</span>
    <span class="nl">Ltmp1:</span>
        <span class="n">movq</span> <span class="o">%</span><span class="n">rdi</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">rbp</span><span class="p">)</span>
        <span class="n">movl</span> <span class="o">%</span><span class="n">esi</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">(</span><span class="o">%</span><span class="n">rbp</span><span class="p">)</span>
        <span class="n">movl</span> <span class="o">%</span><span class="n">edx</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span><span class="p">(</span><span class="o">%</span><span class="n">rbp</span><span class="p">)</span>
        <span class="n">movl</span> <span class="o">-</span><span class="mi">12</span><span class="p">(</span><span class="o">%</span><span class="n">rbp</span><span class="p">),</span> <span class="o">%</span><span class="n">eax</span>
        <span class="n">movl</span> <span class="o">-</span><span class="mi">16</span><span class="p">(</span><span class="o">%</span><span class="n">rbp</span><span class="p">),</span> <span class="o">%</span><span class="n">ecx</span>
        <span class="n">cmpl</span> <span class="o">%</span><span class="n">ecx</span><span class="p">,</span> <span class="o">%</span><span class="n">eax</span>
        <span class="n">jle</span>  <span class="n">LBB1_2</span>
        <span class="n">movl</span> <span class="o">-</span><span class="mi">12</span><span class="p">(</span><span class="o">%</span><span class="n">rbp</span><span class="p">),</span> <span class="o">%</span><span class="n">eax</span>
        <span class="n">movl</span> <span class="o">%</span><span class="n">eax</span><span class="p">,</span> <span class="o">-</span><span class="mi">24</span><span class="p">(</span><span class="o">%</span><span class="n">rbp</span><span class="p">)</span>
        <span class="n">jmp</span>  <span class="n">LBB1_3</span>
    <span class="nl">LBB1_2:</span>
        <span class="n">movl</span> <span class="o">-</span><span class="mi">16</span><span class="p">(</span><span class="o">%</span><span class="n">rbp</span><span class="p">),</span> <span class="o">%</span><span class="n">eax</span>
        <span class="n">movl</span> <span class="o">%</span><span class="n">eax</span><span class="p">,</span> <span class="o">-</span><span class="mi">24</span><span class="p">(</span><span class="o">%</span><span class="n">rbp</span><span class="p">)</span>
    <span class="nl">LBB1_3:</span>
        <span class="n">movl</span> <span class="o">-</span><span class="mi">24</span><span class="p">(</span><span class="o">%</span><span class="n">rbp</span><span class="p">),</span> <span class="o">%</span><span class="n">eax</span>
        <span class="n">movl</span> <span class="o">%</span><span class="n">eax</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">(</span><span class="o">%</span><span class="n">rbp</span><span class="p">)</span>
        <span class="n">movl</span> <span class="o">-</span><span class="mi">20</span><span class="p">(</span><span class="o">%</span><span class="n">rbp</span><span class="p">),</span> <span class="o">%</span><span class="n">eax</span>
        <span class="n">popq</span> <span class="o">%</span><span class="n">rbp</span>
        <span class="n">ret</span>
    <span class="nl">Leh_func_end1:</span>
</code></pre>
</div>


<p>(…)</p>

<p>Gruselig oder nicht? Zu unserem Glück müssen wir so etwas weder schreiben noch lesen können. Von 1969 bis 1973 würde die Sprache C von Dennis Ritchie ( Quelle The C Programming Language von Brian W. Kernighan &amp; Dennis Ritchie) im "Bell Labs Computing Sciences Research Center" entwickelt. Diese Sprache wird beim Kompilieren in Assembler Code übersetzt. Der Vorteil dabei ist eine viel einfachere Syntax die es erlaubt den Schwerpunkt der Aufmerksamkeit auf das Konzept des Programms zu richten.</p>

<h4>ANSI C noObject.c</h4>

<p>Im Unterschied zu C++ und JavaScript ist die Sprache C nicht für eine Objektorientierung ausgelegt. Deshalb hier einmal das Beispiel noObject.c welches die gestellte Aufgabe des Vergleich löst aber kein Objekt erzeugt. Die Syntax ähnelt hier sehr der von JavaScript. Sobald jedoch Pointer hinzukommen wird es schwer kompliziert.</p>

<p>Aber ich schweife ab. Keine Sorge mit Problemen wie: "In welchem Speicher lege ich meine Variable ab" und "Habe ich auch den Müll rausgetragen" (Das löschen eines unbenutzten Objekts wird "Garbadge Collection" also "Müll sammeln" genannt), werden wir in JavaScript nicht konfrontiert. All diese Funktionalität wird von der Maschine im Hintergrund erledigt. Somit bleibt Zeit sich mit der Funktionsweise und Konzept zu beschäftigen. Stellen sie es sich vor wie es wäre entweder das Auto vor dem Fahren zusammen zu bauen oder einfach in das fertige Auto einzusteigen und loszufahren." Um die Abstammung von JavaScript verstehen zu können habe ich die Vergleichs-Funktion in C geschrieben.</p>

<div class="highlight"><pre><code class="c"><span class="c">// include the io lib</span>
<span class="cp">#include&lt;stdio.h&gt;</span>
<span class="c">// the compare function takes integer as arguments </span>
<span class="kt">int</span> <span class="n">compare</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span><span class="k">return</span> <span class="n">b</span><span class="p">;}</span>
<span class="p">}</span>
<span class="c">// the main function</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
    <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;Hello World&quot;</span><span class="p">;</span> <span class="c">// our string</span>
    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">23</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="c">// the values to compare</span>
    <span class="c">// now print all that stuff</span>
    <span class="c">// with %s you insert string arguments</span>
    <span class="c">// with %d digits </span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;The Object named: %s</span><span class="se">\n</span><span class="s">Compared: %d with %d.</span><span class="se">\n</span><span class="s">%d is bigger!&quot;</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">compare</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">));</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span><span class="c">// everything went fine return 0</span>
<span class="p">}</span>
</code></pre>
</div>




<br /> <a href="images/terminal_c_cpp.png"><img src="images/terminal_c_cpp.png" width="100%" alt="" /></a>


<h4>C++ (anObject.cpp)</h4>

<p>Basierend auf C wurde Ende der Siebziger Anfang der Achtziger Jahre des letzten Jahrtausends die Sprache C++ von Bjarne Stroustrup in den AT&amp;T Labs entwickelt (Quelle: Bjarne_Stroustrup_-_The_C++_Programming_Language_3rd_Ed <a href="http://www.ib.cnea.gov.ar/~oop/biblio/Bjarne_Stroustrup_-_The_C++_Programming_Language_3rd_Ed.pdf">online</a>). Diese Sprache ist nach dem Konzept der Objektorientierung (OO) aufgebaut. OO hat den Vorteil des Versteckens beziehungsweise Kapseln von Daten. Es kommt die Klasse hinzu. Sie erlaubt ganze Programmteile auszulagern und nur einen Schnittstille für ihre Benutzung zu liefern. Für genauere Erklärungen lesen sie den Abschnitt [NUMMER ABSCHNITT]
In diesem Beispiel ist bereits zu sehen, dass die Menge an Code die geschrieben werden muss geringer wird (im Vergleich zum Assembler Code). Wobei hier wie auch im C Beispiel bedacht werden muss, dass bereits vorhandene Programmteile mit weiteren hunderten oder tausenden Zeilen Code hinzugefügt werden.</p>

<div class="highlight"><pre><code class="cpp"><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;string&gt; </span>
 
</code></pre>
</div>


<p>Mit den obigen 2 Zeilen werden fertige Klassen eingebunden. "iostream" um die Ein- und Ausgabe des Programms zu handhaben und "string" um Zeichenketten zu verarbeiten. Der Unterschied ist enorm. Während in C eine Zeichenkette noch eine Liste einzelner Zeichen ist wird in C++ ein Zeichenkette als ein einziges Objekt gehandhabt und bringt viele Funktionen mit zur Verarbeitung dieser.</p>

<div class="highlight"><pre><code class="cpp"><span class="c">// the string and io classes</span>
<span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;string&gt;</span>

<span class="c">//using namespace std; // if you use this you can remove all &quot;std::&quot;</span>
<span class="k">class</span> <span class="nc">Object</span><span class="p">{</span> <span class="c">/* our object*/</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">;</span> <span class="c">// its name</span>

    <span class="n">Object</span><span class="p">(){}</span><span class="c">// basis constructor</span>
    <span class="n">Object</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">in</span><span class="p">){</span><span class="n">name</span> <span class="o">=</span> <span class="n">in</span><span class="p">;}</span><span class="c">// another constructor</span>
    <span class="kt">int</span> <span class="n">compare</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">);</span><span class="c">//Prototype for comparsion</span>
    <span class="kt">void</span> <span class="n">setName</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">in</span><span class="p">){</span><span class="n">name</span> <span class="o">=</span> <span class="n">in</span><span class="p">;}</span> <span class="c">// to set the name</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="n">Object</span><span class="o">::</span><span class="n">compare</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">){</span><span class="c">/* the compare function*/</span>
    <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="p">;}</span><span class="k">else</span><span class="p">{</span><span class="k">return</span> <span class="n">b</span><span class="p">;}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(){</span> <span class="c">/* now the main program*/</span>
    <span class="n">Object</span><span class="o">*</span> <span class="n">myObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="p">(</span><span class="s">&quot;Hello World CPP&quot;</span><span class="p">);</span><span class="c">// make a new object</span>

    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">23</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span><span class="c">// declare some values</span>
    <span class="c">// now the output directly with comparsion</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Object named: &quot;</span><span class="o">&lt;&lt;</span> 
    <span class="n">myObject</span><span class="o">-&gt;</span><span class="n">name</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Compared: &quot;</span>
    <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; with &quot;</span>
    <span class="o">&lt;&lt;</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> 
    <span class="o">&lt;&lt;</span> <span class="n">myObject</span><span class="o">-&gt;</span><span class="n">compare</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="o">&lt;&lt;</span><span class="s">&quot; is bigger</span><span class="se">\n</span><span class="s">&quot;</span> 
    <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="c">/* code */</span>
    <span class="k">delete</span> <span class="n">myObject</span><span class="p">;</span> <span class="c">// remove the object from memory</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="c">// everything went fine return 0</span>
<span class="p">}</span>
</code></pre>
</div>




<br />


<h4>JavaScript (anObject.js)</h4>

<p>Im Jahre 1995 wurde die Sprache LiveScript zusammen mit der 2.0 Version von Netscape (ein WEb-Browser) veröffentlicht und bald in JavaScript umbenannt (Quelle: JavaScript das Umfassende Handbuch). Wie in jedem Buch das sich mit JavaScript auseinandersetzt möchte auch ich hier sagen und es dabei belassen:</p>

<h6>Java is to JavaScript like ham to hamster</h6>

<p>Mit JavaScript gehen wir einen Schritt weiter als in C++. Hier sind das Objekt, die Ein-/Ausgabe, der String bereits existent und müssen nicht neu implementiert noch eingebunden werden. Genau genommen ist in JavaScript fast alles ein Objekt. Der massgebende Unterschied ist dass die vorherigen Programme wirklich vollwertige Programme sind die nach dem Kompilieren aus der Kommandozeile ausgeführt werden können. Die JavaScript Variante benötigt ein Programm in dem es ausgeführt wird. Es ist also alleine nicht lauffähig. Dennoch - was wir in C++ in 8 Zeilen schreiben hat in JavaScript nur noch 4 Zeilen.</p>

<div class="highlight"><pre><code class="js"><span class="nx">main</span><span class="p">();</span> <span class="c">// call the main function</span>

<span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span> <span class="c">/* here wee go */</span>

    <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">buildNewObject</span><span class="p">(</span><span class="s2">&quot;Hello JS&quot;</span><span class="p">);</span> <span class="c">// create a new Object</span>
    <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">23</span><span class="o">,</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span> <span class="c">// define the values</span>
    <span class="nx">obj</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">a</span><span class="o">,</span><span class="nx">b</span><span class="p">);</span> <span class="c">// let the object compare the values</span>
    <span class="c">// and make the message</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;The Script named: &quot;</span><span class="o">+</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> 
          <span class="s2">&quot;\nCompared: &quot;</span><span class="o">+</span> <span class="nx">a</span> <span class="o">+</span><span class="s2">&quot; with &quot;</span><span class="o">+</span> <span class="nx">b</span> <span class="o">+</span><span class="s2">&quot;\n&quot;</span> 
          <span class="o">+</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">result</span> <span class="o">+</span> <span class="s2">&quot; is bigger\n&quot;</span><span class="p">);</span>
    <span class="nx">obj</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="c">// delete the object</span>
    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span> <span class="c">// everything went fine return 0</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">buildNewObject</span><span class="p">(</span><span class="nx">n</span><span class="p">){</span><span class="c">/* this is our object builder*/</span>
    <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span> <span class="c">/* create a json object*/</span>
    <span class="nx">name</span><span class="o">:</span><span class="nx">n</span><span class="o">,</span> <span class="c">/* its name is the incoming value*/</span>
    <span class="nx">result</span><span class="o">:</span><span class="mi">0</span><span class="o">,</span> <span class="c">/* this will be set by the compare object*/</span>
    <span class="nx">compare</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="o">,</span><span class="nx">b</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">&gt;</span><span class="nx">b</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">result</span> <span class="o">=</span> <span class="nx">a</span><span class="o">;</span><span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">&lt;</span><span class="nx">b</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">result</span> <span class="o">=</span> <span class="nx">b</span><span class="o">;</span><span class="p">}}</span>
    <span class="p">};</span>
    <span class="k">return</span> <span class="nx">obj</span><span class="o">;</span> <span class="c">// return the new object</span>
<span class="p">};</span>
</code></pre>
</div>




<br /> <a href="images/estk_anobjectjs.png"><img src="images/estk_anobjectjs.png" width="100%" alt="" /></a>


<p>Werfen sie einen Blick auf die Funktion <code>buildNewObject(n)</code>.
Dies ist eine kleine Abwandlung der <code>compare</code> Funktion die wir in der C++ Variante sehen. Die verbesserte Funktion kann die gegebenen Variablen vergleichen und in sich selber mit <code>this.result</code> das Ergebnis festlegen. Um eine solche Funktionalität in einer C++ zu erzeugen bedürfte es einiger Zeilen mehr.
Ohne diese Erweiterung und ohne das Objekt würde das JavaScript es wieder der C Variante ähneln.</p>

<div class="highlight"><pre><code class="js"><span class="nx">main</span><span class="p">();</span>  
<span class="kd">function</span> <span class="nx">main</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">23</span><span class="o">,</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span>
    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;Hello JS&quot;</span><span class="o">;</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">compare</span><span class="p">(</span><span class="nx">a</span><span class="o">,</span><span class="nx">b</span><span class="p">);</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;The Script named: &quot;</span><span class="o">+</span> <span class="nx">name</span> <span class="o">+</span><span class="s2">&quot;\nCompared: &quot;</span>
              <span class="o">+</span> <span class="nx">a</span> <span class="o">+</span><span class="s2">&quot; with &quot;</span><span class="o">+</span> <span class="nx">b</span> <span class="o">+</span><span class="s2">&quot;\n&quot;</span> <span class="o">+</span> <span class="nx">result</span> <span class="o">+</span> <span class="s2">&quot; is bigger\n&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="kd">function</span> <span class="nx">compare</span> <span class="p">(</span><span class="nx">a</span><span class="o">,</span><span class="nx">b</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="o">&gt;</span><span class="nx">b</span><span class="p">){</span>
        <span class="k">return</span>  <span class="nx">a</span><span class="o">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="k">return</span>  <span class="nx">b</span><span class="o">;</span>
    <span class="p">};</span>
<span class="p">};</span>
</code></pre>
</div>




<br /> <a href="images/estk_noobjectjs.png"><img src="images/estk_noobjectjs.png" width="100%" alt="" /></a>


<h3>Was ist der Unterschied zwischen JavaScript und ExtendScript?</h3>

<p>JavaScript oder EcmaScript ist das was uns täglich in Webbrowsern solche Dinge bescherte wie Scrollen auf Knopfdruck oder Warnhinweise und ähnliches. ExtendScript ist ein Dialekt von JavaScript der von Adobe entwickelt wurde. Das bedeutet InDesign versteht JavaScript und ExtendScript aber ein Browser kann mit ExtendScript Befehlen nichts anfangen.</p>

<h3>Was sind Pointer</h3>

<p>Ein Pointer ist der Verwies auf die Adresse unter der eine Variable abgelegt. Dies verweist auf von der Variable okkupierten Speicher. Das kann dann so aussehen:</p>

<div class="highlight"><pre><code class="c"><span class="kt">double</span> <span class="o">*</span><span class="n">dp</span><span class="p">,</span> <span class="n">atof</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">);</span>
</code></pre>
</div>


<blockquote><p>says that in an expression *dp and atof(s) have values of double, and that the argument of atof is a pointer to char.</p>

<p>aus The C programming Language By Brian W. Kernighan and Dennis M. Ritchie. Published by Prentice-Hall in 1988
(<a href="http://net.pku.edu.cn/~course/cs101/2008/resource/The_C_Programming_Language.pdf">online</a>)</p></blockquote>

<h2>JavaScript &amp; ExtendScript Ressourcen</h2>

<p>[NOCH NICHT GESCHRIEBEN]</p>

<h2>Quellenverzeichnis</h2>

<p>[NOCH NICHT GESCHRIEBEN]</p>

  
  <div class="footer">
    Diese Website würde mit <a href="http://jekyllrb.com/">jekyll</a> entwickelt. Alle Inhalte liegen unter <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/de/">CC BY-NC-SA 3.0 Lizenz</a> auf <a href="https://github.com/fabiantheblind/MT4D_TXT">github.com. (NOCH NICHT ÖFFENTLICH)</a>
    <div class="contact">
      <p>
        Fabian Morón Zirfas<br />
        Owner of <a href="http://fabiantheblind.info">fabiantheblind.info</a><br />
        hello@fabiantheblind.info
      </p>
    </div>
    <div class="contact">
      <p>
        <a href="http://github.com/fabiantheblind/">github.com/fabiantheblind</a><br />
        <a href="http://twitter.com/fabiantheblind/">twitter.com/fabiantheblind</a><br />
        <a href="http://flickr.com/photos/fabiantheblind/">flickr.com/photos/fabiantheblind</a><br />
        <a href="https://vimeo.com/fabiantheblind">vimeo.com/fabiantheblind</a>

      </p>
    </div>

    </div>
  </div>
</div>

</body>
</html>
